<!doctype html>
<html lang="de" data-theme="light">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SLMX16ZJ6Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-SLMX16ZJ6Y');
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <title>Ticket‚ÄëBot Panel</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="shortcut icon" href="/images/favicon.png">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="/markdown.css">
  <style>
    :root {
      --bg-color: #f0f8ff;
      --text-color: #1a1a2e;
      --border-color: #bdd7ee;
      --accent-color: #0ea5e9;
      --accent-hover: #0284c7;
      --fieldset-bg: rgba(240, 248, 255, 0.9);
      --thead-bg: #dae9f7;
      --input-bg: #ffffff;
      --code-bg: #e0f2ff;
      --success-bg: #cfe7f3;
      --success-border: #0ea5e9;
      --error-bg: #fee2e2;
      --error-border: #ef4444;
      --glass-bg: rgba(240, 248, 255, 0.7);
      --glass-border: rgba(14, 165, 233, 0.3);
      --shadow-color: rgba(14, 165, 233, 0.15);
    }

    [data-theme="dark"] {
      --bg-color: #0a0a0a;
      --text-color: #00ff88;
      --border-color: #1a3a2a;
      --accent-color: #00ff88;
      --accent-hover: #00dd77;
      --fieldset-bg: rgba(15, 21, 16, 0.9);
      --thead-bg: #0f1f15;
      --input-bg: #0f1510;
      --code-bg: #0a1a0f;
      --success-bg: #0a2015;
      --success-border: #00ff88;
      --error-bg: #2a0a0a;
      --error-border: #ff4444;
      --glass-bg: rgba(15, 21, 16, 0.7);
      --glass-border: rgba(0, 255, 136, 0.3);
      --shadow-color: rgba(0, 255, 136, 0.2);
    }

    [data-theme="dark"] body {
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    [data-theme="dark"] input,
    [data-theme="dark"] select,
    [data-theme="dark"] textarea {
      background-color: var(--input-bg);
      border-color: var(--border-color);
      color: var(--text-color);
    }

    [data-theme="dark"] fieldset {
      background-color: var(--fieldset-bg);
      border-color: var(--border-color);
    }

    [data-theme="dark"] thead {
      background: var(--thead-bg);
    }

    [data-theme="dark"] code {
      background: var(--code-bg);
      color: var(--accent-color);
    }

    [data-theme="dark"] .good {
      background: var(--success-bg);
      border-color: var(--success-border);
      color: var(--accent-color);
    }

    [data-theme="dark"] .bad {
      background: var(--error-bg);
      border-color: var(--error-border);
      color: #ff6666;
    }

    [data-theme="dark"] a {
      color: var(--accent-color);
    }

    [data-theme="dark"] button:not(.del-btn):not(.theme-toggle):not(.settings-toggle) {
      background-color: var(--accent-color);
      color: #000;
    }

    [data-theme="dark"] button:not(.del-btn):not(.theme-toggle):not(.settings-toggle):hover {
      background-color: var(--accent-hover);
    }

    /* Animated Background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: radial-gradient(circle, var(--accent-color) 1px, transparent 1px);
      background-size: 50px 50px;
      opacity: 0.03;
      animation: bgMove 20s linear infinite;
    }

    @keyframes bgMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(50px, 50px); }
    }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    body {
      display: flex;
      flex-direction: row;
      min-height: 100vh;
      width: 100%;
      max-width: 100%;
      padding: 0;
      line-height: 1.8;
      margin: 0;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      body {
        padding: 0 1rem;
      }

      h1 { font-size: 1.5rem; }

      table { font-size: 0.85rem; overflow-x: auto; display: block; }
      th, td { padding: 0.4rem 0.6rem !important; }

      .grid { flex-direction: column !important; }
      fieldset { min-width: 100% !important; padding: 1rem !important; }

      textarea { font-size: 0.9rem; }
      input, select { font-size: 0.9rem; }

      .add-btn, button[type="submit"] {
        width: 100%;
        padding: 0.8rem !important;
      }

      .actions form {
        display: block !important;
        width: 100%;
        margin-bottom: 0.5rem !important;
      }

      .actions select,
      .actions button {
        width: 100% !important;
        margin-right: 0 !important;
        margin-bottom: 0.5rem;
      }

      .theme-toggle {
        top: 0.5rem !important;
        right: 0.5rem !important;
        width: 2.5rem !important;
        height: 2.5rem !important;
        font-size: 1.2rem !important;
      }

      .header-flex {
        flex-direction: column;
        align-items: flex-start !important;
        gap: 1rem;
      }

      /* Tabellen horizontal scrollbar */
      table {
        min-width: 600px;
      }

      /* Formfelder Stack */
      .topic-row {
        flex-direction: column !important;
        gap: 0.5rem !important;
      }

      .topic-row input {
        width: 100% !important;
      }
    }

    /* Tablet Responsive */
    @media (min-width: 769px) and (max-width: 1024px) {
      body {
        padding: 0 2rem;
      }

      .grid {
        gap: 1.5rem !important;
      }

      fieldset {
        flex: 1 1 600px !important;
        min-width: 500px !important;
      }
    }

    main {
      flex: 1;
    }
    table { width:100%; border-collapse:collapse; }
    th,td { padding:.6rem .8rem; }
    table input, table select { width:100%; }
    .grid { display:flex; flex-wrap:wrap; gap:2rem; }
    fieldset {
      flex:1 1 800px;
      min-width:740px;
      padding:2rem;
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 2px solid var(--glass-border);
      box-shadow: 0 8px 32px var(--shadow-color);
      transition: all 0.3s ease;
    }
    fieldset:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 40px var(--shadow-color);
    }
    textarea { width:100%; font-family: monospace; resize:vertical; }
    .bad { border:1px solid var(--error-border); padding:1rem 1.5rem; border-radius:6px; background: var(--error-bg); margin:1rem 0; }
    .good { border:1px solid var(--success-border); padding:1rem 1.5rem; border-radius:6px; background: var(--success-bg); margin:1rem 0; }
    .actions form { display:inline-block; margin-right:1rem; }
    footer { margin-top:3rem; margin-bottom: 3rem; padding-bottom: 2rem; font-size:.7rem; opacity:.6; }

    [data-theme="dark"] footer {
      margin-bottom: 4rem;
      padding-bottom: 3rem;
    }
    .placeholder-list code { margin-right:.4rem; }
    .add-btn { margin-top:.5rem; }
    .soft-note { font-size:.7rem; opacity:.65; }
    .del-btn { background:#e55353; color:#fff; border:0; padding:.25rem .55rem; border-radius:4px; cursor:pointer; font-size:.7rem; }
    .del-btn:hover { background:#c84242; }
    thead { background: var(--thead-bg); }
    .mini { font-size:.65rem; opacity:.55; }

    .theme-toggle {
      position: fixed;
      top: 1.5rem;
      right: 1.5rem;
      background: var(--accent-color);
      color: #000;
      border: 0;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      z-index: 1000;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
      background: var(--accent-hover);
    }

    [data-theme="dark"] .theme-toggle {
      background: var(--accent-color);
      box-shadow: 0 2px 12px rgba(0,255,136,0.4);
    }

    .header-flex {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .server-info {
      font-size: 0.85rem;
      opacity: 0.7;
    }

    [data-theme="dark"] .server-info {
      color: var(--accent-color);
    }

    [data-theme="dark"] select {
      background: var(--accent-color) !important;
      color: #000 !important;
    }

    .nav-buttons {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    .nav-buttons a {
      padding: 0.6rem 1.2rem;
      background: var(--accent-color);
      color: #000;
      text-decoration: none;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      border: 2px solid transparent;
    }

    .nav-buttons a:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,184,148,0.3);
    }

    [data-theme="dark"] .nav-buttons a {
      background: var(--accent-color);
      color: #000;
    }

    [data-theme="dark"] .nav-buttons a:hover {
      background: var(--accent-hover);
      box-shadow: 0 4px 12px rgba(0,255,136,0.4);
    }

    .nav-buttons a.secondary-btn {
      background: transparent;
      border-color: var(--accent-color);
      color: var(--accent-color);
    }

    .nav-buttons a.secondary-btn:hover {
      background: var(--accent-color);
      color: #000;
    }

    @media (max-width: 768px) {
      .nav-buttons {
        flex-direction: column;
      }

      .nav-buttons a {
        width: 100%;
        justify-content: center;
      }
    }

    /* Custom Language Dropdown with Flags */
    .lang-dropdown {
      position: fixed;
      top: 1.5rem;
      right: 5.5rem;
      z-index: 1000;
    }

    .lang-dropdown-toggle {
      background: var(--accent-color);
      color: #000;
      border: 0;
      padding: 0.75rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.2s;
    }

    .lang-dropdown-toggle:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .lang-dropdown-toggle img {
      width: 24px;
      height: 18px;
      border-radius: 2px;
    }

    .lang-dropdown-menu {
      position: absolute;
      top: calc(100% + 0.5rem);
      right: 0;
      background: var(--card-bg);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      display: none;
      min-width: 180px;
      overflow: hidden;
    }

    .lang-dropdown-menu.show {
      display: block;
    }

    .lang-dropdown-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      color: var(--text-color);
      border-bottom: 1px solid var(--border-color);
    }

    .lang-dropdown-item:last-child {
      border-bottom: none;
    }

    .lang-dropdown-item:hover {
      background: var(--accent-color);
      color: #000;
    }

    .lang-dropdown-item.active {
      background: var(--accent-color);
      color: #000;
      font-weight: 600;
    }

    .lang-dropdown-item img {
      width: 24px;
      height: 18px;
      border-radius: 2px;
    }

    @media (max-width: 768px) {
      .lang-dropdown {
        top: 0.5rem;
        right: 3.5rem;
      }

      .lang-dropdown-toggle {
        padding: 0.5rem 0.75rem;
        font-size: 0.85rem;
      }
    }

    /* Loading Overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.95);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 99999;
      flex-direction: column;
      gap: 2rem;
    }

    .loading-overlay.show {
      display: flex;
    }

    .loading-content {
      text-align: center;
      background: rgba(255,255,255,0.05);
      padding: 3rem;
      border-radius: 20px;
      border: 1px solid rgba(0,255,136,0.2);
      max-width: 400px;
      width: 90%;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 6px solid rgba(0,255,136,0.1);
      border-top: 6px solid var(--accent-color);
      border-radius: 50%;
      animation: loadingSpin 1s linear infinite;
      margin: 0 auto 2rem;
    }

    .loading-text {
      font-size: 1.3rem;
      color: var(--accent-color);
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .loading-subtext {
      font-size: 0.9rem;
      opacity: 0.7;
      color: var(--text-color);
    }

    @keyframes loadingSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Sidebar Layout */
    .sidebar {
      width: 280px;
      min-width: 280px;
      height: 100vh;
      position: sticky;
      top: 0;
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-right: 2px solid var(--glass-border);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      z-index: 100;
    }

    .sidebar-header {
      padding: 2rem 1.5rem 1.5rem;
      border-bottom: 2px solid var(--glass-border);
    }

    .sidebar-logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .sidebar-logo i {
      font-size: 2rem;
      color: var(--accent-color);
    }

    .sidebar-logo-text {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-color);
    }

    .sidebar-server-info {
      background: rgba(0, 0, 0, 0.05);
      padding: 1rem;
      border-radius: 0.75rem;
      border: 1px solid var(--glass-border);
    }

    [data-theme="dark"] .sidebar-server-info {
      background: rgba(0, 255, 136, 0.05);
    }

    .sidebar-server-name {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
      color: var(--text-color);
    }

    .sidebar-server-id {
      font-size: 0.75rem;
      opacity: 0.6;
      font-family: 'Courier New', monospace;
    }

    .sidebar-nav {
      flex: 1;
      padding: 1.5rem 0;
    }

    .sidebar-nav-section {
      margin-bottom: 2rem;
    }

    .sidebar-nav-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      font-weight: 700;
      opacity: 0.5;
      padding: 0 1.5rem;
      margin-bottom: 0.75rem;
    }

    .sidebar-nav-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--text-color);
      text-decoration: none;
      transition: all 0.2s;
      border-left: 3px solid transparent;
      font-size: 0.95rem;
    }

    .sidebar-nav-item:hover {
      background: rgba(0, 0, 0, 0.05);
      border-left-color: var(--accent-color);
    }

    [data-theme="dark"] .sidebar-nav-item:hover {
      background: rgba(0, 255, 136, 0.1);
    }

    .sidebar-nav-item.active {
      background: rgba(0, 0, 0, 0.08);
      border-left-color: var(--accent-color);
      font-weight: 600;
    }

    [data-theme="dark"] .sidebar-nav-item.active {
      background: rgba(0, 255, 136, 0.15);
    }

    .sidebar-nav-item i {
      width: 20px;
      text-align: center;
      font-size: 1.1rem;
    }

    .sidebar-premium-badge {
      margin: 0 1.5rem 1.5rem;
      padding: 1rem;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
      border: 2px solid rgba(102, 126, 234, 0.3);
      border-radius: 0.75rem;
      text-align: center;
    }

    .sidebar-premium-badge.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-color: #667eea;
    }

    .sidebar-premium-icon {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .sidebar-premium-text {
      font-size: 0.85rem;
      font-weight: 600;
    }

    .sidebar-premium-badge.active .sidebar-premium-text {
      color: white;
    }

    .sidebar-footer {
      padding: 1.5rem;
      border-top: 2px solid var(--glass-border);
      text-align: center;
      font-size: 0.7rem;
      opacity: 0.6;
    }

    .main-content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
      height: 100vh;
    }

    .content-header {
      margin-bottom: 2rem;
    }

    .content-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent-color);
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    /* Mobile Sidebar Toggle */
    .sidebar-toggle {
      display: none;
      position: fixed;
      top: 1rem;
      left: 1rem;
      background: var(--accent-color);
      color: #000;
      border: 0;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5rem;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      z-index: 1001;
    }

    .sidebar-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 99;
    }

    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }

      .sidebar {
        position: fixed;
        left: -280px;
        transition: left 0.3s ease;
        z-index: 1000;
      }

      .sidebar.open {
        left: 0;
      }

      .sidebar-overlay.active {
        display: block;
      }

      .sidebar-toggle {
        display: flex;
      }

      .main-content {
        padding: 1rem;
        margin-top: 4rem;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text" id="loadingText">Wird gespeichert...</div>
      <div class="loading-subtext">Bitte warten</div>
    </div>
  </div>

  <div class="lang-dropdown">
    <button class="lang-dropdown-toggle" onclick="toggleLangDropdown()">
      <%
        const langFlags = { de: 'de', en: 'gb', he: 'il', ja: 'jp', ru: 'ru', pt: 'pt', es: 'es', id: 'id', zh: 'zh', ar: 'ar' };
        const langNames = { de: 'Deutsch', en: 'English', he: '◊¢◊ë◊®◊ô◊™', ja: 'Êó•Êú¨Ë™û', ru: '–†—É—Å—Å–∫–∏–π', pt: 'Portugu√™s', es: 'Espa√±ol', id: 'Bahasa Indonesia', zh: '‰∏≠Êñá', ar: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©' };
      %>
      <img src="/images/flags/<%= langFlags[lang] %>.svg" alt="<%= lang %>">
      <span><%= langNames[lang] %></span>
      <i class="fas fa-chevron-down" style="font-size: 0.7rem; margin-left: 0.25rem;"></i>
    </button>
    <div class="lang-dropdown-menu" id="langDropdownMenu">
      <a href="/set-language/de" class="lang-dropdown-item <%= lang === 'de' ? 'active' : '' %>">
        <img src="/images/flags/de.svg" alt="DE">
        <span>Deutsch</span>
      </a>
      <a href="/set-language/en" class="lang-dropdown-item <%= lang === 'en' ? 'active' : '' %>">
        <img src="/images/flags/gb.svg" alt="EN">
        <span>English</span>
      </a>
      <a href="/set-language/he" class="lang-dropdown-item <%= lang === 'he' ? 'active' : '' %>">
        <img src="/images/flags/il.svg" alt="HE">
        <span>◊¢◊ë◊®◊ô◊™</span>
      </a>
      <a href="/set-language/ja" class="lang-dropdown-item <%= lang === 'ja' ? 'active' : '' %>">
        <img src="/images/flags/jp.svg" alt="JA">
        <span>Êó•Êú¨Ë™û</span>
      </a>
      <a href="/set-language/ru" class="lang-dropdown-item <%= lang === 'ru' ? 'active' : '' %>">
        <img src="/images/flags/ru.svg" alt="RU">
        <span>–†—É—Å—Å–∫–∏–π</span>
      </a>
      <a href="/set-language/pt" class="lang-dropdown-item <%= lang === 'pt' ? 'active' : '' %>">
        <img src="/images/flags/pt.svg" alt="PT">
        <span>Portugu√™s</span>
      </a>
      <a href="/set-language/es" class="lang-dropdown-item <%= lang === 'es' ? 'active' : '' %>">
        <img src="/images/flags/es.svg" alt="ES">
        <span>Espa√±ol</span>
      </a>
      <a href="/set-language/id" class="lang-dropdown-item <%= lang === 'id' ? 'active' : '' %>">
        <img src="/images/flags/id.svg" alt="ID">
        <span>Bahasa Indonesia</span>
      </a>
      <a href="/set-language/zh" class="lang-dropdown-item <%= lang === 'zh' ? 'active' : '' %>">
        <img src="/images/flags/zh.svg" alt="ZH">
        <span>‰∏≠Êñá</span>
      </a>
      <a href="/set-language/ar" class="lang-dropdown-item <%= lang === 'ar' ? 'active' : '' %>">
        <img src="/images/flags/ar.svg" alt="AR">
        <span>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</span>
      </a>
    </div>
  </div>
  <button class="theme-toggle" onclick="toggleTheme()" title="Dark Mode umschalten">
    <i id="themeIcon" class="fas fa-moon"></i>
  </button>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <!-- Sidebar Header -->
    <div class="sidebar-header">
      <!-- Logo -->
      <div class="sidebar-logo">
        <i class="fas fa-ticket-alt" style="font-size: 1.8rem; color: var(--accent-color);"></i>
        <div>
          <div style="font-size: 1.2rem; font-weight: 700; color: var(--text-color);">Quantix Tickets</div>
          <div style="font-size: 0.75rem; opacity: 0.7; color: var(--text-color);">Admin Panel</div>
        </div>
      </div>

      <!-- Server Info -->
      <div class="sidebar-server-info">
        <% if (typeof guild !== 'undefined' && guild) { %>
          <% if (guild.icon) { %>
            <img src="https://cdn.discordapp.com/icons/<%= guild.id %>/<%= guild.icon %>.png?size=64" alt="Server Icon" style="width: 40px; height: 40px; border-radius: 50%; margin-right: 0.75rem;">
          <% } else { %>
            <div style="width: 40px; height: 40px; border-radius: 50%; background: var(--accent-color); display: flex; align-items: center; justify-content: center; margin-right: 0.75rem; font-weight: bold; color: white;">
              <%= guild.name.charAt(0).toUpperCase() %>
            </div>
          <% } %>
          <div style="flex: 1; min-width: 0;">
            <div style="font-weight: 600; font-size: 0.95rem; color: var(--text-color); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><%= guild.name %></div>
            <div style="font-size: 0.75rem; opacity: 0.7; color: var(--text-color);"><%= guild.id %></div>
          </div>
        <% } %>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="sidebar-nav">
      <!-- Main Section -->
      <div class="sidebar-nav-section">
        <div class="sidebar-nav-title">
          <%= lang === 'de' ? 'Haupt' : lang === 'en' ? 'Main' : lang === 'he' ? '◊®◊ê◊©◊ô' : lang === 'ja' ? '„É°„Ç§„É≥' : lang === 'ru' ? '–ì–ª–∞–≤–Ω–æ–µ' : lang === 'pt' ? 'Principal' : lang === 'es' ? 'Principal' : lang === 'id' ? 'Utama' : lang === 'zh' ? '‰∏ªË¶Å' : lang === 'ar' ? 'ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©' : 'Haupt' %>
        </div>
        <a href="/" class="sidebar-nav-item">
          <i class="fas fa-home"></i>
          <span><%= lang === 'de' ? 'Zur Startseite' : lang === 'en' ? 'Back to Home' : lang === 'he' ? '◊ó◊ñ◊®◊î ◊ú◊ì◊£ ◊î◊ë◊ô◊™' : lang === 'ja' ? '„Éõ„Éº„É†„Å´Êàª„Çã' : lang === 'ru' ? '–ù–∞ –≥–ª–∞–≤–Ω—É—é' : lang === 'pt' ? 'Voltar ao In√≠cio' : lang === 'es' ? 'Volver al Inicio' : lang === 'id' ? 'Kembali ke Beranda' : lang === 'zh' ? 'ËøîÂõûÈ¶ñÈ°µ' : lang === 'ar' ? 'ÿßŸÑÿπŸàÿØÿ© ÿ•ŸÑŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©' : 'Zur Startseite' %></span>
        </a>
        <a href="/panel" class="sidebar-nav-item active">
          <i class="fas fa-cog"></i>
          <span><%= lang === 'de' ? 'Einstellungen' : lang === 'en' ? 'Settings' : lang === 'he' ? '◊î◊í◊ì◊®◊ï◊™' : lang === 'ja' ? 'Ë®≠ÂÆö' : lang === 'ru' ? '–ù–∞—Å—Ç—Ä–æ–π–∫–∏' : lang === 'pt' ? 'Configura√ß√µes' : lang === 'es' ? 'Configuraci√≥n' : lang === 'id' ? 'Pengaturan' : lang === 'zh' ? 'ËÆæÁΩÆ' : lang === 'ar' ? 'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™' : 'Einstellungen' %></span>
        </a>
        <a href="/select-server" class="sidebar-nav-item">
          <i class="fas fa-server"></i>
          <span><%= lang === 'de' ? 'Server wechseln' : lang === 'en' ? 'Change Server' : lang === 'he' ? '◊î◊ó◊ú◊£ ◊©◊®◊™' : lang === 'ja' ? '„Çµ„Éº„Éê„Éº„ÇíÂ§âÊõ¥' : lang === 'ru' ? '–°–º–µ–Ω–∏—Ç—å —Å–µ—Ä–≤–µ—Ä' : lang === 'pt' ? 'Trocar Servidor' : lang === 'es' ? 'Cambiar Servidor' : lang === 'id' ? 'Ganti Server' : lang === 'zh' ? 'ÂàáÊç¢ÊúçÂä°Âô®' : lang === 'ar' ? 'ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿÆÿßÿØŸÖ' : 'Server wechseln' %></span>
        </a>
      </div>

      <!-- Tickets Section -->
      <div class="sidebar-nav-section">
        <div class="sidebar-nav-title">
          <%= lang === 'de' ? 'Tickets' : lang === 'en' ? 'Tickets' : lang === 'he' ? '◊õ◊®◊ò◊ô◊°◊ô◊ù' : lang === 'ja' ? '„ÉÅ„Ç±„ÉÉ„Éà' : lang === 'ru' ? '–¢–∏–∫–µ—Ç—ã' : lang === 'pt' ? 'Tickets' : lang === 'es' ? 'Tickets' : lang === 'id' ? 'Tiket' : lang === 'zh' ? 'Â∑•Âçï' : lang === 'ar' ? 'ÿßŸÑÿ™ÿ∞ÿßŸÉÿ±' : 'Tickets' %>
        </div>
        <a href="/tickets" class="sidebar-nav-item">
          <i class="fas fa-history"></i>
          <span><%= lang === 'de' ? 'Ticket-Verlauf' : lang === 'en' ? 'Ticket History' : lang === 'he' ? '◊î◊ô◊°◊ò◊ï◊®◊ô◊ô◊™ ◊õ◊®◊ò◊ô◊°◊ô◊ù' : lang === 'ja' ? '„ÉÅ„Ç±„ÉÉ„ÉàÂ±•Ê≠¥' : lang === 'ru' ? '–ò—Å—Ç–æ—Ä–∏—è —Ç–∏–∫–µ—Ç–æ–≤' : lang === 'pt' ? 'Hist√≥rico de Tickets' : lang === 'es' ? 'Historial de Tickets' : lang === 'id' ? 'Riwayat Tiket' : lang === 'zh' ? 'Â∑•ÂçïÂéÜÂè≤' : lang === 'ar' ? 'ÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ∞ÿßŸÉÿ±' : 'Ticket-Verlauf' %></span>
        </a>
        <% if (premiumTier === 'pro' || premiumTier === 'beta' || guildId === '1291125037876904026') { %>
        <a href="/analytics" class="sidebar-nav-item">
          <i class="fas fa-chart-line"></i>
          <span><%= lang === 'de' ? 'Analytics' : lang === 'en' ? 'Analytics' : lang === 'he' ? '◊ê◊†◊ú◊ô◊ò◊ô◊ß◊î' : lang === 'ja' ? '„Ç¢„Éä„É™„ÉÜ„Ç£„ÇØ„Çπ' : lang === 'ru' ? '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞' : lang === 'pt' ? 'An√°lise' : lang === 'es' ? 'Anal√≠tica' : lang === 'id' ? 'Analitik' : lang === 'zh' ? 'ÂàÜÊûê' : lang === 'ar' ? 'ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™' : 'Analytics' %></span>
        </a>
        <% } %>
      </div>

      <!-- Support Section -->
      <div class="sidebar-nav-section">
        <div class="sidebar-nav-title">
          <%= lang === 'de' ? 'Support' : lang === 'en' ? 'Support' : lang === 'he' ? '◊™◊û◊ô◊õ◊î' : lang === 'ja' ? '„Çµ„Éù„Éº„Éà' : lang === 'ru' ? '–ü–æ–¥–¥–µ—Ä–∂–∫–∞' : lang === 'pt' ? 'Suporte' : lang === 'es' ? 'Soporte' : lang === 'id' ? 'Dukungan' : lang === 'zh' ? 'ÊîØÊåÅ' : lang === 'ar' ? 'ÿßŸÑÿØÿπŸÖ' : 'Support' %>
        </div>
        <a href="https://dc.theredstonee.de/" target="_blank" rel="noopener noreferrer" class="sidebar-nav-item">
          <i class="fab fa-discord"></i>
          <span><%= lang === 'de' ? 'Support Discord' : lang === 'en' ? 'Support Discord' : lang === 'he' ? '◊™◊û◊ô◊õ◊î Discord' : lang === 'ja' ? '„Çµ„Éù„Éº„Éà Discord' : lang === 'ru' ? '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Discord' : lang === 'pt' ? 'Suporte Discord' : lang === 'es' ? 'Soporte Discord' : lang === 'id' ? 'Dukungan Discord' : lang === 'zh' ? 'ÊîØÊåÅ Discord' : lang === 'ar' ? 'ÿØÿπŸÖ Discord' : 'Support Discord' %></span>
        </a>
      </div>
    </nav>

    <!-- Premium Badge in Sidebar -->
    <% if (isPremium) { %>
    <div class="sidebar-premium-badge" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
      <div style="display: flex; align-items: center; gap: 0.75rem;">
        <span style="font-size: 1.5rem;">üíé</span>
        <div style="flex: 1;">
          <div style="font-weight: 700; font-size: 0.9rem; color: white;"><%= premiumTierName %></div>
          <div style="font-size: 0.75rem; opacity: 0.9; color: white;"><%= lang === 'de' ? 'Aktiv' : lang === 'en' ? 'Active' : lang === 'he' ? '◊§◊¢◊ô◊ú' : lang === 'ja' ? '„Ç¢„ÇØ„ÉÜ„Ç£„Éñ' : lang === 'ru' ? '–ê–∫—Ç–∏–≤–µ–Ω' : lang === 'pt' ? 'Ativo' : lang === 'es' ? 'Activo' : lang === 'id' ? 'Aktif' : lang === 'zh' ? 'Ê¥ªË∑É' : lang === 'ar' ? 'ŸÜÿ¥ÿ∑' : 'Aktiv' %></div>
        </div>
      </div>
      <a href="/premium" style="display: block; margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 6px; font-size: 0.85rem; font-weight: 600; text-align: center; transition: all 0.2s;">
        <%= t.premium.badge_manage %>
      </a>
    </div>
    <% } else { %>
    <div class="sidebar-premium-badge" style="background: rgba(102, 126, 234, 0.1); border: 2px solid rgba(102, 126, 234, 0.3);">
      <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
        <span style="font-size: 1.5rem;">‚ú®</span>
        <div style="flex: 1;">
          <div style="font-weight: 700; font-size: 0.9rem; color: var(--text-color);"><%= lang === 'de' ? 'Free Plan' : lang === 'en' ? 'Free Plan' : lang === 'he' ? '◊™◊ï◊õ◊†◊ô◊™ ◊ó◊ô◊†◊û◊ô◊™' : lang === 'ja' ? 'ÁÑ°Êñô„Éó„É©„É≥' : lang === 'ru' ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : lang === 'pt' ? 'Plano Gr√°tis' : lang === 'es' ? 'Plan Gratis' : lang === 'id' ? 'Paket Gratis' : lang === 'zh' ? 'ÂÖçË¥πËÆ°Âàí' : lang === 'ar' ? 'ÿÆÿ∑ÿ© ŸÖÿ¨ÿßŸÜŸäÿ©' : 'Free Plan' %></div>
          <div style="font-size: 0.75rem; opacity: 0.7; color: var(--text-color);"><%= lang === 'de' ? 'Upgrade f√ºr mehr' : lang === 'en' ? 'Upgrade for more' : lang === 'he' ? '◊©◊ì◊®◊í ◊ú◊¢◊ï◊ì' : lang === 'ja' ? '„Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ' : lang === 'ru' ? '–û–±–Ω–æ–≤–∏—Ç–µ' : lang === 'pt' ? 'Atualize' : lang === 'es' ? 'Actualiza' : lang === 'id' ? 'Upgrade' : lang === 'zh' ? 'ÂçáÁ∫ß' : lang === 'ar' ? 'ÿ™ÿ±ŸÇŸäÿ©' : 'Upgrade f√ºr mehr' %></div>
        </div>
      </div>
      <a href="/premium" style="display: block; padding: 0.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; border-radius: 6px; font-size: 0.85rem; font-weight: 600; text-align: center; transition: all 0.2s;">
        <%= t.premium.badge_upgrade_btn %>
      </a>
    </div>
    <% } %>

    <!-- Sidebar Footer -->
    <div class="sidebar-footer">
      <div style="font-size: 0.75rem; opacity: 0.6; text-align: center; color: var(--text-color);">
        ¬© 2025 Quantix Development
      </div>
    </div>
  </aside>

  <!-- Mobile Toggle Button -->
  <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()" aria-label="Toggle Sidebar">
    <i class="fas fa-bars"></i>
  </button>

  <!-- Mobile Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="content-header">
      <h1 class="content-title"><i class="fas fa-ticket-alt"></i> <%= t.web.title %></h1>
    </div>

  <!-- Read-Only Mode Notice for Team Members -->
  <% if (typeof isAdmin !== 'undefined' && !isAdmin) { %>
  <div style="margin: 2rem 0; padding: 1.5rem; background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); border-radius: 15px; color: white; text-align: center; box-shadow: 0 4px 20px rgba(243, 156, 18, 0.4);">
    <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; flex-wrap: wrap;">
      <span style="font-size: 2.5rem;">üëÅÔ∏è</span>
      <div style="text-align: left;">
        <h3 style="margin: 0; font-size: 1.5rem; color: white;">
          <%= lang === 'de' ? 'Nur-Lese-Modus' : lang === 'en' ? 'Read-Only Mode' : lang === 'he' ? '◊û◊¶◊ë ◊ß◊®◊ô◊ê◊î ◊ë◊ú◊ë◊ì' : lang === 'ja' ? 'Ë™≠„ÅøÂèñ„ÇäÂ∞ÇÁî®„É¢„Éº„Éâ' : lang === 'ru' ? '–†–µ–∂–∏–º —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è' : lang === 'pt' ? 'Modo Somente Leitura' : lang === 'es' ? 'Modo Solo Lectura' : lang === 'id' ? 'Mode Hanya Baca' : lang === 'ar' ? 'Ÿàÿ∂ÿπ ÿßŸÑŸÇÿ±ÿßÿ°ÿ© ŸÅŸÇÿ∑' : 'Nur-Lese-Modus' %>
        </h3>
        <p style="margin: 0.5rem 0 0 0; opacity: 0.9; font-size: 0.9rem;">
          <%= lang === 'de' ? 'Du kannst als Team-Mitglied alle Einstellungen sehen, aber keine √Ñnderungen vornehmen. Nur Administratoren k√∂nnen Einstellungen bearbeiten.' : lang === 'en' ? 'As a team member, you can view all settings but cannot make changes. Only administrators can edit settings.' : lang === 'he' ? '◊õ◊ó◊ë◊® ◊¶◊ï◊ï◊™, ◊ê◊™◊î ◊ô◊õ◊ï◊ú ◊ú◊®◊ê◊ï◊™ ◊ê◊™ ◊õ◊ú ◊î◊î◊í◊ì◊®◊ï◊™ ◊ê◊ö ◊ú◊ê ◊ú◊ë◊¶◊¢ ◊©◊ô◊†◊ï◊ô◊ô◊ù. ◊®◊ß ◊û◊†◊î◊ú◊ô◊ù ◊ô◊õ◊ï◊ú◊ô◊ù ◊ú◊¢◊®◊ï◊ö ◊î◊í◊ì◊®◊ï◊™.' : lang === 'ja' ? '„ÉÅ„Éº„É†„É°„É≥„Éê„Éº„Å®„Åó„Å¶„ÄÅ„Åô„Åπ„Å¶„ÅÆË®≠ÂÆö„ÇíË°®Á§∫„Åß„Åç„Åæ„Åô„Åå„ÄÅÂ§âÊõ¥„ÅØ„Åß„Åç„Åæ„Åõ„Çì„ÄÇÁÆ°ÁêÜËÄÖ„ÅÆ„Åø„ÅåË®≠ÂÆö„ÇíÁ∑®ÈõÜ„Åß„Åç„Åæ„Åô„ÄÇ' : lang === 'ru' ? '–ö–∞–∫ —á–ª–µ–Ω –∫–æ–º–∞–Ω–¥—ã, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç–µ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è. –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.' : lang === 'pt' ? 'Como membro da equipe, voc√™ pode ver todas as configura√ß√µes, mas n√£o pode fazer altera√ß√µes. Apenas administradores podem editar configura√ß√µes.' : lang === 'es' ? 'Como miembro del equipo, puedes ver todas las configuraciones pero no puedes hacer cambios. Solo los administradores pueden editar configuraciones.' : lang === 'id' ? 'Sebagai anggota tim, Anda dapat melihat semua pengaturan tetapi tidak dapat melakukan perubahan. Hanya administrator yang dapat mengedit pengaturan.' : lang === 'ar' ? 'ŸÉÿπÿ∂Ÿà ŸÅŸä ÿßŸÑŸÅÿ±ŸäŸÇÿå ŸäŸÖŸÉŸÜŸÉ ÿπÿ±ÿ∂ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸàŸÑŸÉŸÜ ŸÑÿß ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ¨ÿ±ÿßÿ° ÿ™ÿ∫ŸäŸäÿ±ÿßÿ™. ŸäŸÖŸÉŸÜ ŸÑŸÑŸÖÿ≥ÿ§ŸàŸÑŸäŸÜ ŸÅŸÇÿ∑ ÿ™ÿ≠ÿ±Ÿäÿ± ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™.' : 'Du kannst als Team-Mitglied alle Einstellungen sehen, aber keine √Ñnderungen vornehmen. Nur Administratoren k√∂nnen Einstellungen bearbeiten.' %>
        </p>
      </div>
    </div>
  </div>
  <% } %>

  <% if (msg==='saved')  { %><p class="good"><%= t.web.messages.saved %></p><% } %>
  <% if (msg==='sent')   { %><p class="good"><%= t.web.messages.sent %></p><% } %>
  <% if (msg==='edited') { %><p class="good"><%= t.web.messages.edited %></p><% } %>
  <% if (msg==='nopanel'){ %><p class="bad"><%= t.web.messages.nopanel %></p><% } %>
  <% if (msg==='error')  { %><p class="bad"><%= t.web.messages.error %></p><% } %>

  <form method="POST" autocomplete="off" id="panelForm">
    <div class="grid">

      <!-- Server Einstellungen -->
      <fieldset>
        <legend><i class="fas fa-server"></i> <%= t.web.server_settings %></legend>
        <label><%= t.web.guild_id %>
          <input name="guildId" value="<%= cfg.guildId || guildId || '' %>" placeholder="1234567890123456789" readonly style="background: var(--fieldset-bg); cursor: not-allowed;">
        </label>
        <label><%= t.web.ticket_category %>
          <select name="ticketCategoryId">
            <option value=""><%= t.web.select_category %></option>
            <% channels.filter(ch => ch.type === 4).forEach(ch => { %>
              <option value="<%= ch.id %>" <%= cfg.ticketCategoryId === ch.id ? 'selected' : '' %>>
                üìÅ <%= ch.name %>
              </option>
            <% }) %>
          </select>
        </label>
        <label><%= t.web.log_channel %>
          <select name="logChannelId">
            <option value=""><%= t.web.select_channel %></option>
            <% channels.filter(ch => ch.type === 0).forEach(ch => { %>
              <option value="<%= ch.id %>" <%= cfg.logChannelId === ch.id ? 'selected' : '' %>>
                # <%= ch.name %>
              </option>
            <% }) %>
          </select>
        </label>
        <label><%= t.web.transcript_channel %>
          <select name="transcriptChannelId">
            <option value=""><%= t.web.select_channel %></option>
            <% channels.filter(ch => ch.type === 0).forEach(ch => { %>
              <option value="<%= ch.id %>" <%= cfg.transcriptChannelId === ch.id ? 'selected' : '' %>>
                # <%= ch.name %>
              </option>
            <% }) %>
          </select>
        </label>
        <label><%= t.web.team_role %> (Legacy)
          <select name="teamRoleId">
            <option value=""><%= t.web.select_role %></option>
            <% roles.forEach(role => { %>
              <option value="<%= role.id %>" <%= cfg.teamRoleId === role.id ? 'selected' : '' %>>
                @ <%= role.name %>
              </option>
            <% }) %>
          </select>
        </label>
        <p class="soft-note">Guild ID wird automatisch gesetzt. Legacy Team-Rolle f√ºr R√ºckw√§rtskompatibilit√§t.</p>
      </fieldset>

      <!-- Priority Rollen (NEU) -->
      <fieldset>
        <legend><i class="fas fa-users-cog"></i> Priorit<%= lang === 'he' ? '◊ô◊ï◊™' : '√§' %>ts-Rollen (Multi-Level)</legend>
        <p class="soft-note">Lege fest welche Rollen Zugriff auf Tickets mit spezifischer Priorit<%= lang === 'he' ? '◊ô◊ï◊™' : '√§' %>t haben. Mehrfachauswahl mit STRG/CMD.</p>

        <label>üü¢ Gr√ºn (Niedrig) - Rollen
          <select name="priorityRoles_0" multiple size="5" style="height: auto;">
            <%
            const green = (cfg.priorityRoles && cfg.priorityRoles['0']) || [];
            roles.forEach(role => { %>
              <option value="<%= role.id %>" <%= green.includes(role.id) ? 'selected' : '' %>>
                @ <%= role.name %>
              </option>
            <% }) %>
          </select>
        </label>

        <label>üü† Orange (Mittel) - Rollen
          <select name="priorityRoles_1" multiple size="5" style="height: auto;">
            <%
            const orange = (cfg.priorityRoles && cfg.priorityRoles['1']) || [];
            roles.forEach(role => { %>
              <option value="<%= role.id %>" <%= orange.includes(role.id) ? 'selected' : '' %>>
                @ <%= role.name %>
              </option>
            <% }) %>
          </select>
        </label>

        <label>üî¥ Rot (Hoch) - Rollen
          <select name="priorityRoles_2" multiple size="5" style="height: auto;">
            <%
            const red = (cfg.priorityRoles && cfg.priorityRoles['2']) || [];
            roles.forEach(role => { %>
              <option value="<%= role.id %>" <%= red.includes(role.id) ? 'selected' : '' %>>
                @ <%= role.name %>
              </option>
            <% }) %>
          </select>
        </label>

        <div class="soft-note" style="margin-top: 1rem; padding: 1rem; background: var(--fieldset-bg); border-radius: 6px; border-left: 4px solid var(--accent-color);">
          <strong>üìù Vorschau:</strong><br>
          <span style="font-size: 0.85rem;">
            üü¢ Gr√ºn: <%= green.length %> Rolle(n) |
            üü† Orange: <%= orange.length %> Rolle(n) |
            üî¥ Rot: <%= red.length %> Rolle(n)
          </span>
        </div>
      </fieldset>

      <!-- Premium Features -->
      <fieldset style="border: 2px solid <%= isPremium ? '#667eea' : 'rgba(102, 126, 234, 0.3)' %>; <%= isPremium ? 'background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);' : '' %>">
        <legend>
          <i class="fas fa-gem"></i> üíé Premium Features
          <%= isPremium ? '| ' + premiumTierName : '' %>
        </legend>

        <%
        // Feature-Definitionen mit Pl√§nen
        const features = [
          { name: t.premium.feature_ticket_categories, icon: 'üìÅ', free: 3, basic: 7, pro: 999, current: true },
          { name: t.premium.feature_no_ads, icon: 'üö´', free: false, basic: true, pro: true },
          { name: t.premium.feature_custom_avatar, icon: 'üé®', free: false, basic: true, pro: true },
          { name: t.premium.feature_statistics, icon: 'üìä', free: false, basic: true, pro: true },
          { name: t.premium.feature_priority_support, icon: '‚ö°', free: false, basic: true, pro: true },
          { name: t.premium.feature_auto_close, icon: '‚è∞', free: false, basic: false, pro: true },
          { name: t.premium.feature_email_notifications, icon: 'üìß', free: false, basic: false, pro: true, config: true },
          { name: t.premium.feature_dm_notifications, icon: 'üîî', free: false, basic: false, pro: true, config: true }
        ];
        %>

        <!-- Feature-√úbersicht -->
        <div style="margin-bottom: 1.5rem; padding: 1rem; background: var(--fieldset-bg); border-radius: 8px;">
          <strong style="font-size: 1.1rem;"><%= t.premium.feature_overview %></strong>
          <table style="margin-top: 1rem; width: 100%; font-size: 0.9rem;">
            <thead style="background: var(--thead-bg);">
              <tr>
                <th style="text-align: left; padding: 0.75rem;">Feature</th>
                <th style="text-align: center; padding: 0.75rem; background: <%= premiumTier === 'none' ? 'rgba(0,184,148,0.1)' : 'transparent' %>;">
                  <%= t.premium.tier_free %>
                </th>
                <th style="text-align: center; padding: 0.75rem; background: <%= premiumTier === 'basic' ? 'rgba(102,126,234,0.1)' : 'transparent' %>;">
                  <%= t.premium.tier_basic %>
                </th>
                <th style="text-align: center; padding: 0.75rem; background: <%= premiumTier === 'pro' || premiumTier === 'beta' ? 'rgba(118,75,162,0.15)' : 'transparent' %>;">
                  <%= t.premium.tier_pro %>
                </th>
              </tr>
            </thead>
            <tbody>
              <% features.forEach(feature => { %>
              <tr style="border-bottom: 1px solid var(--border-color);">
                <td style="padding: 0.75rem;">
                  <%= feature.icon %> <%= feature.name %>
                </td>
                <td style="text-align: center; padding: 0.75rem;">
                  <% if (typeof feature.free === 'number') { %>
                    <span style="color: var(--accent-color); font-weight: bold;"><%= feature.free %></span>
                  <% } else if (feature.free) { %>
                    <span style="color: #00ff88;">‚úì</span>
                  <% } else { %>
                    <span style="opacity: 0.3;">‚Äî</span>
                  <% } %>
                </td>
                <td style="text-align: center; padding: 0.75rem;">
                  <% if (typeof feature.basic === 'number') { %>
                    <span style="color: #667eea; font-weight: bold;"><%= feature.basic %></span>
                  <% } else if (feature.basic) { %>
                    <span style="color: #667eea;">‚úì</span>
                  <% } else { %>
                    <span style="opacity: 0.3;">‚Äî</span>
                  <% } %>
                </td>
                <td style="text-align: center; padding: 0.75rem;">
                  <% if (typeof feature.pro === 'number') { %>
                    <span style="color: #764ba2; font-weight: bold;">‚ôæÔ∏è</span>
                  <% } else if (feature.pro) { %>
                    <span style="color: #764ba2;">‚úì</span>
                  <% } else { %>
                    <span style="opacity: 0.3;">‚Äî</span>
                  <% } %>
                </td>
              </tr>
              <% }) %>
            </tbody>
          </table>
        </div>

        <% if (!isPremium) { %>
        <!-- Upgrade CTA f√ºr Free-User -->
        <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%); border-radius: 10px; text-align: center; margin-bottom: 1.5rem; border: 2px dashed rgba(102, 126, 234, 0.4);">
          <span style="font-size: 2rem; display: block; margin-bottom: 0.5rem;">‚ú®</span>
          <h3 style="margin: 0 0 0.5rem 0; color: #667eea;"><%= t.premium.upgrade_cta_title %></h3>
          <p style="margin: 0 0 1rem 0; opacity: 0.8; font-size: 0.9rem;">
            <%= t.premium.upgrade_cta_description %>
          </p>
          <a href="/premium" style="display: inline-block; padding: 0.75rem 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; border-radius: 8px; font-weight: bold; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.2s;">
            <%= t.premium.upgrade_cta_button %>
          </a>
        </div>
        <% } %>

        <!-- Konfigurierbare Features -->
        <div style="margin-top: 1.5rem; padding: 1.5rem; background: var(--fieldset-bg); border-radius: 8px; border: 2px solid rgba(102, 126, 234, 0.2);">
          <strong style="font-size: 1.1rem; display: block; margin-bottom: 1rem;">‚öôÔ∏è Konfigurierbare Features</strong>

          <!-- Email-Benachrichtigungen (nur Pro) -->
          <% if (premiumTier === 'pro' || premiumTier === 'beta' || guildId === '1291125037876904026') { %>
          <div style="margin-bottom: 1.5rem;">
            <label>
              <%= t.premium.email_notifications_label %>
              <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
              <input
                type="email"
                name="notificationEmail"
                value="<%= cfg.notificationEmail || '' %>"
                placeholder="<%= t.premium.email_notifications_placeholder %>"
                style="margin-top: 0.5rem;"
              >
              <small style="opacity: 0.7; font-size: 0.85rem; display: block; margin-top: 0.5rem;">
                <%= t.premium.email_notifications_description %>
              </small>
            </label>
          </div>

          <!-- Auto-Close System (nur Pro) -->
          <div style="margin-bottom: 1.5rem;">
            <label>
              <%= t.premium.auto_close_label %>
              <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
              <div style="display: flex; gap: 1rem; align-items: center; margin-top: 0.5rem;">
                <input
                  type="checkbox"
                  name="autoCloseEnabled"
                  id="autoCloseEnabled"
                  <%= cfg.autoCloseEnabled ? 'checked' : '' %>
                  style="width: auto; margin: 0;"
                >
                <label for="autoCloseEnabled" style="margin: 0; cursor: pointer;">
                  <%= t.premium.auto_close_enable %>
                </label>
              </div>
              <div style="margin-top: 0.75rem;">
                <input
                  type="number"
                  name="autoCloseDays"
                  value="<%= cfg.autoCloseDays || 7 %>"
                  min="1"
                  max="365"
                  placeholder="7"
                  style="width: 100px;"
                  <%= !cfg.autoCloseEnabled ? 'disabled' : '' %>
                >
                <span style="margin-left: 0.5rem;"><%= t.premium.auto_close_days %></span>
              </div>
              <small style="opacity: 0.7; font-size: 0.85rem; display: block; margin-top: 0.5rem;">
                <%= t.premium.auto_close_description %>
              </small>
            </label>
          </div>

          <!-- Custom Bot-Avatar (Basic+) -->
          <div style="margin-bottom: 1.5rem;">
            <label>
              <%= t.premium.custom_avatar_label %>
              <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">BASIC+</span>
              <input
                type="url"
                name="customAvatarUrl"
                value="<%= cfg.customAvatarUrl || '' %>"
                placeholder="<%= t.premium.custom_avatar_placeholder %>"
                style="margin-top: 0.5rem;"
              >
              <small style="opacity: 0.7; font-size: 0.85rem; display: block; margin-top: 0.5rem;">
                <%= t.premium.custom_avatar_description %>
              </small>
            </label>
          </div>

          <!-- Discord DM-Benachrichtigungen (nur Pro) -->
          <div style="margin-bottom: 1.5rem;">
            <label>
              <%= t.premium.dm_notifications_label %>
              <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
              <textarea
                name="dmNotificationUsers"
                rows="3"
                placeholder="<%= t.premium.dm_notifications_placeholder %>"
                style="margin-top: 0.5rem; font-family: monospace; font-size: 0.9rem;"
              ><%= (cfg.dmNotificationUsers || []).join('\n') %></textarea>
              <small style="opacity: 0.7; font-size: 0.85rem; display: block; margin-top: 0.5rem;">
                <%= t.premium.dm_notifications_description %>
              </small>
            </label>
          </div>

          <% } else if (premiumTier === 'basic') { %>
          <!-- Basic User: Nur Custom Avatar -->
          <div style="margin-bottom: 1.5rem;">
            <label>
              <%= t.premium.custom_avatar_label %>
              <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">BASIC+</span>
              <input
                type="url"
                name="customAvatarUrl"
                value="<%= cfg.customAvatarUrl || '' %>"
                placeholder="<%= t.premium.custom_avatar_placeholder %>"
                style="margin-top: 0.5rem;"
              >
              <small style="opacity: 0.7; font-size: 0.85rem; display: block; margin-top: 0.5rem;">
                <%= t.premium.custom_avatar_description %>
              </small>
            </label>
          </div>

          <!-- Pro-Features Locked -->
          <div style="padding: 1rem; background: rgba(118, 75, 162, 0.1); border-left: 4px solid #764ba2; border-radius: 6px; margin-top: 1rem;">
            <strong><%= t.premium.email_notifications_label %></strong>
            <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
            <br>
            <span style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem; display: block;">
              <%= t.premium.feature_locked_pro %>
            </span>
          </div>

          <div style="padding: 1rem; background: rgba(118, 75, 162, 0.1); border-left: 4px solid #764ba2; border-radius: 6px; margin-top: 1rem;">
            <strong><%= t.premium.auto_close_label %></strong>
            <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
            <br>
            <span style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem; display: block;">
              <%= t.premium.feature_locked_pro %>
            </span>
          </div>

          <div style="padding: 1rem; background: rgba(118, 75, 162, 0.1); border-left: 4px solid #764ba2; border-radius: 6px; margin-top: 1rem;">
            <strong><%= t.premium.dm_notifications_label %></strong>
            <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
            <br>
            <span style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem; display: block;">
              <%= t.premium.feature_locked_pro %>
            </span>
          </div>

          <% } else { %>
          <!-- Free User: Alle Features Locked -->
          <div style="padding: 1rem; background: rgba(102, 126, 234, 0.1); border-left: 4px solid #667eea; border-radius: 6px; margin-bottom: 1rem;">
            <strong><%= t.premium.custom_avatar_label %></strong>
            <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">BASIC+</span>
            <br>
            <span style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem; display: block;">
              <%= t.premium.feature_locked_basic %>
            </span>
          </div>

          <div style="padding: 1rem; background: rgba(118, 75, 162, 0.1); border-left: 4px solid #764ba2; border-radius: 6px; margin-bottom: 1rem;">
            <strong><%= t.premium.email_notifications_label %></strong>
            <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
            <br>
            <span style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem; display: block;">
              <%= t.premium.feature_locked_pro %>
            </span>
          </div>

          <div style="padding: 1rem; background: rgba(118, 75, 162, 0.1); border-left: 4px solid #764ba2; border-radius: 6px; margin-bottom: 1rem;">
            <strong><%= t.premium.auto_close_label %></strong>
            <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
            <br>
            <span style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem; display: block;">
              <%= t.premium.feature_locked_pro %>
            </span>
          </div>

          <div style="padding: 1rem; background: rgba(118, 75, 162, 0.1); border-left: 4px solid #764ba2; border-radius: 6px;">
            <strong><%= t.premium.dm_notifications_label %></strong>
            <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;">PRO</span>
            <br>
            <span style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem; display: block;">
              <%= t.premium.feature_locked_pro %>
            </span>
          </div>
          <% } %>
        </div>

        <!-- Kategorie-Limit Anzeige -->
        <div style="margin-top: 1.5rem; padding: 1rem; background: var(--fieldset-bg); border-radius: 8px; border-left: 4px solid var(--accent-color);">
          <strong><%= t.premium.category_limit_title %></strong>
          <br>
          <span style="font-size: 1.2rem; color: var(--accent-color); font-weight: bold; margin-top: 0.5rem; display: block;">
            <%= premiumTier === 'pro' || premiumTier === 'beta' || guildId === '1291125037876904026' ? t.premium.category_limit_unlimited : premiumTier === 'basic' ? '7 ' + t.premium.feature_ticket_categories : '3 ' + t.premium.feature_ticket_categories %>
          </span>
          <% if (premiumTier === 'none') { %>
          <span style="font-size: 0.85rem; opacity: 0.8; margin-top: 0.5rem; display: block;">
            <%= t.premium.category_limit_hint %>
          </span>
          <% } %>
        </div>

        <% if (isPremium) { %>
        <p style="margin-top: 1rem; text-align: center;">
          <a href="/premium" style="color: #667eea; text-decoration: none; font-weight: 600;">
            <%= t.premium.manage_subscription %>
          </a>
        </p>
        <% } %>
      </fieldset>

      <!-- GitHub Commit Logs (NEU) -->
      <fieldset>
        <legend><i class="fab fa-github"></i> GitHub Commit Logs</legend>
<p class="soft-note">Konfiguriere wo GitHub Commits vom Quantix-Tickets-Bot Repository geloggt werden sollen.</p>

        <label>üì¢ GitHub Webhook Channel
          <select name="githubWebhookChannelId">
            <option value=""><%= t.web.select_channel %></option>
            <% channels.filter(ch => ch.type === 0).forEach(ch => { %>
              <option value="<%= ch.id %>" <%= cfg.githubWebhookChannelId === ch.id ? 'selected' : '' %>>
                # <%= ch.name %>
              </option>
            <% }) %>
          </select>
        </label>

        <div style="margin-top: 1rem; padding: 1rem; background: var(--fieldset-bg); border-radius: 6px; border-left: 4px solid <%= cfg.githubCommitsEnabled !== false ? '#00ff88' : '#ff4444' %>;">
          <strong>Status:</strong>
          <%= cfg.githubCommitsEnabled !== false ? '‚úÖ Aktiviert' : '‚ùå Deaktiviert' %>
          <br>
          <span style="font-size: 0.85rem; opacity: 0.8;">
            Verwende den <code>/github-commits</code> Command im Discord um den Status zu √§ndern.
          </span>
          <% if (cfg.githubWebhookChannelId) { %>
            <br>
            <span style="font-size: 0.85rem; opacity: 0.8;">
              Logs werden gesendet an: <strong><%= channels.find(ch => ch.id === cfg.githubWebhookChannelId)?.name || 'Unbekannt' %></strong>
            </span>
          <% } else { %>
            <br>
            <span style="font-size: 0.85rem; opacity: 0.8; color: #ff6666;">
              ‚ö†Ô∏è Kein Webhook-Channel ausgew√§hlt! Bitte w√§hle einen Channel aus.
            </span>
          <% } %>
        </div>

        <p class="soft-note" style="margin-top: 1rem;">
          üí° <strong>Webhook URL Setup:</strong><br>
          1. W√§hle oben den Channel aus<br>
          2. Speichere die Einstellungen<br>
          3. F√ºge in deinem GitHub Repository die Webhook-URL hinzu:<br>
          <code style="font-size: 0.75rem; word-break: break-all;">
            <%= process.env.PUBLIC_BASE_URL || 'https://tickets.quantix-bot.de' %>/webhook/github
          </code><br>
          4. Content-Type: <code>application/json</code><br>
          5. Event: <strong>Pushes</strong> (oder "Just the push event")
        </p>
      </fieldset>

      <!-- Topics -->
      <fieldset>
        <legend><%= t.web.topics %></legend>
        <table>
          <thead>
            <tr><th><%= t.web.topic_label %>*</th><th><%= t.web.topic_value %></th><th><%= t.web.topic_emoji %></th><th><%= t.web.delete %></th></tr>
          </thead>
          <tbody id="topicRows">
            <% (cfg.topics||[]).forEach(topic=>{ %>
              <tr>
                <td><input name="label" value="<%= topic.label %>" required></td>
                <td><input name="value" value="<%= topic.value %>" placeholder="auto"></td>
                <td><input name="emoji" value="<%= topic.emoji||'' %>"></td>
                <td><button type="button" class="del-btn" onclick="delRow(this)">‚úñ</button></td>
              </tr>
            <% }) %>
          </tbody>
        </table>
        <button type="button" class="add-btn" onclick="addTopicRow()">‚ûï Topic</button>
        <p class="soft-note">Ist <b>Value</b> leer, wird es aus dem Label generiert (klein + Bindestriche).</p>
      </fieldset>

      <!-- Ticket Embed -->
      <fieldset>
        <legend><%= t.web.ticket_embed %></legend>
        <p class="placeholder-list soft-note"><%= t.web.placeholders %>: <code>{userMention}</code> <code>{userId}</code> <code>{topicLabel}</code> <code>{topicValue}</code> <code>{ticketNumber}</code></p>
        <label><%= t.web.embed_title %> <input name="embedTitle" value="<%= cfg.ticketEmbed?.title || '' %>"></label>
        <label><%= t.web.embed_description %> <textarea name="embedDescription" rows="7"><%= cfg.ticketEmbed?.description || '' %></textarea></label>
        <label><%= t.web.embed_color %> <input name="embedColor" value="<%= cfg.ticketEmbed?.color || '#2b90d9' %>" placeholder="#2b90d9"></label>
        <label><%= t.web.embed_footer %> <input name="embedFooter" value="<%= cfg.ticketEmbed?.footer || '' %>"></label>
      </fieldset>

      <!-- Panel Embed -->
      <fieldset>
        <legend><%= t.web.panel_embed %></legend>
        <label><%= t.web.embed_title %> <input name="panelTitle" value="<%= cfg.panelEmbed?.title || '' %>"></label>
        <label><%= t.web.embed_description %> <textarea name="panelDescription" rows="6"><%= cfg.panelEmbed?.description || '' %></textarea></label>
        <label><%= t.web.embed_color %> <input name="panelColor" value="<%= cfg.panelEmbed?.color || '#5865F2' %>" placeholder="#5865F2"></label>
        <label><%= t.web.embed_footer %> <input name="panelFooter" value="<%= cfg.panelEmbed?.footer || '' %>"></label>
      </fieldset>

      <!-- Formular Felder -->
      <fieldset>
        <legend>Benutzer‚ÄëFormular Felder</legend>
        <p class="soft-note">Diese Felder MUSS der Nutzer beim Ticket erstellen ausf√ºllen (Modal √∂ffnet sich nach Themenwahl).</p>
        <table>
          <thead>
            <tr><th>Label*</th><th>Placeholder</th><th>Typ</th><th>Required</th><th>L√∂schen</th></tr>
          </thead>
          <tbody id="formRows">
            <% (cfg.formFields||[]).forEach(f=>{ %>
              <tr>
                <td><input name="ffLabel" value="<%= f.label %>" required></td>
                <td><input name="ffPlaceholder" value="<%= f.placeholder||'' %>"></td>
                <td>
                  <select name="ffType">
                    <option value="short" <%= f.type==='short'?'selected':'' %>>Kurz</option>
                    <option value="paragraph" <%= f.type==='paragraph'?'selected':'' %>>Lang</option>
                    <option value="number" <%= f.type==='number'?'selected':'' %>>Zahl</option>
                  </select>
                </td>
                <td style="text-align:center"><input type="checkbox" name="ffRequired" <%= f.required? 'checked':'' %>></td>
                <td><button type="button" class="del-btn" onclick="delRow(this)">‚úñ</button></td>
              </tr>
            <% }) %>
          </tbody>
        </table>
        <button type="button" class="add-btn" onclick="addFormRow()">‚ûï Feld</button>
        <p class="soft-note mini">Typen: <b>short</b> = kurzer Text, <b>paragraph</b> = langer Text, <b>number</b> = numerisch (als Text gespeichert).</p>
        <label class="soft-note">FormFields (JSON Vorschau)
          <textarea id="formFieldsJson" name="formFieldsJson" rows="8"><%= JSON.stringify(cfg.formFields || [], null, 2) %></textarea>
        </label>
      </fieldset>

      <!-- Raw Topics JSON (optional) -->
      <fieldset>
        <legend>Topics JSON (optional)</legend>
        <p class="soft-note">Wird nur benutzt wenn keine Topic‚ÄëZeile (Label) vorhanden ist.</p>
        <label>Topics (JSON)
          <textarea name="topicsJson" rows="8" id="topicsJson"><%= JSON.stringify(cfg.topics || [], null, 2) %></textarea>
        </label>
      </fieldset>

      <!-- Umgebungsvariablen Info -->
      <fieldset>
        <legend>üîß Umgebungsvariablen (.env)</legend>
        <p class="soft-note">Diese Einstellungen m√ºssen direkt in der <code>.env</code> Datei auf dem Server bearbeitet werden:</p>
        <ul class="soft-note" style="margin-top: 0.5rem; line-height: 1.8;">
          <li><code>DISCORD_TOKEN</code> - Bot Token</li>
          <li><code>CLIENT_ID</code> - OAuth2 Client ID</li>
          <li><code>CLIENT_SECRET</code> - OAuth2 Client Secret</li>
          <li><code>PUBLIC_BASE_URL</code> - √ñffentliche URL (z.B. https://tickets.quantix-bot.de)</li>
          <li><code>SESSION_SECRET</code> - Session Secret f√ºr Web-Panel</li>
        </ul>
        <p class="soft-note" style="margin-top: 0.8rem;">‚ö†Ô∏è Aus Sicherheitsgr√ºnden k√∂nnen diese Werte nicht √ºber das Web-Panel ge√§ndert werden.</p>
      </fieldset>

    </div>
    <% if (typeof isAdmin === 'undefined' || isAdmin) { %>
    <button type="submit">üíæ <%= t.web.save %></button>
    <% } %>
  </form>

  <% if (typeof isAdmin === 'undefined' || isAdmin) { %>
  <hr>
  <h2><%= t.web.panel_actions %></h2>
  <div class="actions">
    <form action="/panel/send" method="POST">
      <select name="channelId" required style="min-width: 250px;">
        <option value=""><%= t.web.select_channel %></option>
        <% channels.filter(ch => ch.type === 0).forEach(ch => { %>
          <option value="<%= ch.id %>" <%= cfg.panelChannelId === ch.id ? 'selected' : '' %>>
            # <%= ch.name %>
          </option>
        <% }) %>
      </select>
      <button><i class="fas fa-paper-plane"></i> <%= t.web.send_panel %></button>
    </form>
    <form action="/panel/edit" method="POST">
      <button><i class="fas fa-edit"></i> <%= t.web.edit_panel %></button>
    </form>
    <a href="/tickets" role="button" class="secondary"><i class="fas fa-history"></i> <%= t.web.ticket_history %></a>
  </div>
  <% } %>

  <footer>
    <p>Quantix Tickets ¬© 2025 Quantix Development ‚Ä¢ Alle Rechte vorbehalten ‚Ä¢ Version <%= version %></p>
    <p class="soft-note">√Ñnderungen speichern sofort in <code>config.json</code></p>
  </footer>

  </div><!-- End Main Content -->

<script>
function delRow(btn){ const tr=btn.closest('tr'); if(tr) tr.remove(); syncFormJson(); syncTopicsPreview(); }
function addTopicRow(){ const tr=document.createElement('tr'); tr.innerHTML=`<td><input name="label" required></td><td><input name="value" placeholder="auto"></td><td><input name="emoji"></td><td><button type="button" class="del-btn" onclick="delRow(this)">‚úñ</button></td>`; document.getElementById('topicRows').appendChild(tr); }
function addFormRow(data={label:'',placeholder:'',type:'short',required:false}){ const tr=document.createElement('tr'); tr.innerHTML=`<td><input name="ffLabel" value="${esc(data.label)}" required></td><td><input name="ffPlaceholder" value="${esc(data.placeholder)}"></td><td><select name="ffType"><option value="short" ${data.type==='short'?'selected':''}>Kurz</option><option value="paragraph" ${data.type==='paragraph'?'selected':''}>Lang</option><option value="number" ${data.type==='number'?'selected':''}>Zahl</option></select></td><td style="text-align:center"><input type="checkbox" name="ffRequired" ${data.required?'checked':''}></td><td><button type="button" class="del-btn" onclick="delRow(this)">‚úñ</button></td>`; document.getElementById('formRows').appendChild(tr); syncFormJson(); }
function esc(s){return String(s).replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]));}
function syncFormJson(){ const labels=[...document.querySelectorAll('#formRows input[name="ffLabel"]')]; const arr=[]; labels.forEach((inp,idx)=>{ const label=inp.value.trim(); if(!label) return; const placeholder=document.querySelectorAll('#formRows input[name="ffPlaceholder"]')[idx].value.trim(); const type=document.querySelectorAll('#formRows select[name="ffType"]')[idx].value; const required=document.querySelectorAll('#formRows input[name="ffRequired"]')[idx].checked; const obj={label,type}; if(placeholder) obj.placeholder=placeholder; if(required) obj.required=true; arr.push(obj); }); document.getElementById('formFieldsJson').value=JSON.stringify(arr,null,2); }
function syncTopicsPreview(){ const labels=[...document.querySelectorAll('#topicRows input[name="label"]')]; if(!labels.length) return; const arr=[]; labels.forEach((inp,idx)=>{ const L=inp.value.trim(); if(!L) return; const V=document.querySelectorAll('#topicRows input[name="value"]')[idx].value.trim() || L.toLowerCase().replace(/\s+/g,'-'); const E=document.querySelectorAll('#topicRows input[name="emoji"]')[idx].value.trim(); arr.push(E?{label:L,value:V,emoji:E}:{label:L,value:V}); }); document.getElementById('topicsJson').value=JSON.stringify(arr,null,2); }
document.getElementById('formRows').addEventListener('input',syncFormJson);
document.getElementById('topicRows').addEventListener('input',syncTopicsPreview);
// Vor Submit leere Label-Zeilen entfernen
document.getElementById('panelForm').addEventListener('submit',()=>{ [...document.querySelectorAll('#topicRows tr')].forEach(tr=>{ if(!tr.querySelector('input[name="label"]').value.trim()) tr.remove(); }); syncFormJson(); });

// Theme Toggle
function toggleTheme() {
  const html = document.documentElement;
  const currentTheme = html.getAttribute('data-theme');
  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', newTheme);
  localStorage.setItem('trs-theme', newTheme);
  document.getElementById('themeIcon').className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
}

// Theme beim Laden setzen
(function() {
  const savedTheme = localStorage.getItem('trs-theme') || 'light';
  document.documentElement.setAttribute('data-theme', savedTheme);
  document.getElementById('themeIcon').className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
})();

// Language Dropdown Toggle
function toggleLangDropdown() {
  const menu = document.getElementById('langDropdownMenu');
  menu.classList.toggle('show');
}

// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
  const dropdown = document.querySelector('.lang-dropdown');
  const menu = document.getElementById('langDropdownMenu');
  if (dropdown && !dropdown.contains(event.target)) {
    menu.classList.remove('show');
  }
});

// Auto-Close Checkbox Toggle
const autoCloseCheckbox = document.getElementById('autoCloseEnabled');
const autoCloseDaysInput = document.querySelector('input[name="autoCloseDays"]');
if(autoCloseCheckbox && autoCloseDaysInput) {
  autoCloseCheckbox.addEventListener('change', function() {
    autoCloseDaysInput.disabled = !this.checked;
  });
}

// Loading Animations
function showLoading(text, subtext) {
  const overlay = document.getElementById('loadingOverlay');
  const loadingText = document.getElementById('loadingText');
  const loadingSubtext = overlay.querySelector('.loading-subtext');

  loadingText.textContent = text;
  if (subtext) {
    loadingSubtext.textContent = subtext;
  }
  overlay.classList.add('show');
}

// Show loading on main form submit (Save button)
document.getElementById('panelForm').addEventListener('submit', function(e) {
  const lang = '<%= lang %>';
  const texts = {
    de: { text: 'Wird gespeichert...', subtext: 'Bitte warten' },
    en: { text: 'Saving...', subtext: 'Please wait' },
    he: { text: '◊©◊ï◊û◊®...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
    ja: { text: '‰øùÂ≠ò‰∏≠...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
    ru: { text: '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
    pt: { text: 'Salvando...', subtext: 'Por favor, aguarde' },
    es: { text: 'Guardando...', subtext: 'Por favor, espere' },
    id: { text: 'Menyimpan...', subtext: 'Mohon tunggu' },
    ar: { text: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ≠ŸÅÿ∏...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
  };

  const t = texts[lang] || texts.de;
  showLoading(t.text, t.subtext);
});

// Show loading on Send Panel button
document.querySelector('form[action="/panel/send"]').addEventListener('submit', function(e) {
  const lang = '<%= lang %>';
  const texts = {
    de: { text: 'Panel wird gesendet...', subtext: 'Bitte warten' },
    en: { text: 'Sending panel...', subtext: 'Please wait' },
    he: { text: '◊©◊ï◊ú◊ó ◊§◊ê◊†◊ú...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
    ja: { text: '„Éë„Éç„É´„ÇíÈÄÅ‰ø°‰∏≠...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
    ru: { text: '–û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞–Ω–µ–ª–∏...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
    pt: { text: 'Enviando painel...', subtext: 'Por favor, aguarde' },
    es: { text: 'Enviando panel...', subtext: 'Por favor, espere' },
    id: { text: 'Mengirim panel...', subtext: 'Mohon tunggu' },
    ar: { text: 'ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÑŸàÿ≠ÿ©...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
  };

  const t = texts[lang] || texts.de;
  showLoading(t.text, t.subtext);
});

// Show loading on Edit Panel button
document.querySelector('form[action="/panel/edit"]').addEventListener('submit', function(e) {
  const lang = '<%= lang %>';
  const texts = {
    de: { text: 'Panel wird bearbeitet...', subtext: 'Bitte warten' },
    en: { text: 'Editing panel...', subtext: 'Please wait' },
    he: { text: '◊¢◊ï◊®◊ö ◊§◊ê◊†◊ú...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
    ja: { text: '„Éë„Éç„É´„ÇíÁ∑®ÈõÜ‰∏≠...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
    ru: { text: '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–Ω–µ–ª–∏...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
    pt: { text: 'Editando painel...', subtext: 'Por favor, aguarde' },
    es: { text: 'Editando panel...', subtext: 'Por favor, espere' },
    id: { text: 'Mengedit panel...', subtext: 'Mohon tunggu' },
    ar: { text: 'ÿ™ÿ≠ÿ±Ÿäÿ± ÿßŸÑŸÑŸàÿ≠ÿ©...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
  };

  const t = texts[lang] || texts.de;
  showLoading(t.text, t.subtext);
});

// Show loading on Analytics link click
const analyticsLink = document.querySelector('a[href="/analytics"]');
if (analyticsLink) {
  analyticsLink.addEventListener('click', function(e) {
    e.preventDefault();
    const href = this.getAttribute('href');

    const lang = '<%= lang %>';
    const texts = {
      de: { text: 'Analytics wird geladen...', subtext: 'Bitte warten' },
      en: { text: 'Loading analytics...', subtext: 'Please wait' },
      he: { text: '◊ò◊ï◊¢◊ü ◊†◊™◊ï◊†◊ô◊ù...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
      ja: { text: 'ÂàÜÊûê„ÇíË™≠„ÅøËæº„Åø‰∏≠...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
      ru: { text: '–ó–∞–≥—Ä—É–∑–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
      pt: { text: 'Carregando an√°lise...', subtext: 'Por favor, aguarde' },
      es: { text: 'Cargando anal√≠tica...', subtext: 'Por favor, espere' },
      id: { text: 'Memuat analitik...', subtext: 'Mohon tunggu' },
      ar: { text: 'ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
    };

    const t = texts[lang] || texts.de;
    showLoading(t.text, t.subtext);

    setTimeout(() => {
      window.location.href = href;
    }, 100);
  });
}

// Show loading on server switch
const serverSwitchLink = document.querySelector('a[href="/select-server"]');
if (serverSwitchLink) {
  serverSwitchLink.addEventListener('click', function(e) {
    e.preventDefault();
    const href = this.getAttribute('href');

    const lang = '<%= lang %>';
    const texts = {
      de: { text: 'Server wird gewechselt...', subtext: 'Bitte warten' },
      en: { text: 'Switching server...', subtext: 'Please wait' },
      he: { text: '◊û◊ó◊ú◊ô◊£ ◊©◊®◊™...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
      ja: { text: '„Çµ„Éº„Éê„Éº„ÇíÂàá„ÇäÊõø„Åà‰∏≠...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
      ru: { text: '–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
      pt: { text: 'Trocando servidor...', subtext: 'Por favor, aguarde' },
      es: { text: 'Cambiando servidor...', subtext: 'Por favor, espere' },
      id: { text: 'Mengganti server...', subtext: 'Mohon tunggu' },
      ar: { text: 'ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿÆÿßÿØŸÖ...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
    };

    const t = texts[lang] || texts.de;
    showLoading(t.text, t.subtext);

    setTimeout(() => {
      window.location.href = href;
    }, 100);
  });
}

// Show loading on Home link click
const homeLink = document.querySelector('a[href="/"]');
if (homeLink) {
  homeLink.addEventListener('click', function(e) {
    e.preventDefault();
    const href = this.getAttribute('href');

    const lang = '<%= lang %>';
    const texts = {
      de: { text: 'Zur Startseite...', subtext: 'Bitte warten' },
      en: { text: 'Going to home...', subtext: 'Please wait' },
      he: { text: '◊ó◊ñ◊®◊î ◊ú◊ì◊£ ◊î◊ë◊ô◊™...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
      ja: { text: '„Éõ„Éº„É†„Å´ÁßªÂãï‰∏≠...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
      ru: { text: '–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
      pt: { text: 'Indo para in√≠cio...', subtext: 'Por favor, aguarde' },
      es: { text: 'Yendo al inicio...', subtext: 'Por favor, espere' },
      id: { text: 'Ke beranda...', subtext: 'Mohon tunggu' },
      ar: { text: 'ÿßŸÑÿ∞Ÿáÿßÿ® ÿ•ŸÑŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
    };

    const t = texts[lang] || texts.de;
    showLoading(t.text, t.subtext);

    setTimeout(() => {
      window.location.href = href;
    }, 100);
  });
}

// Show loading on Ticket History link click
const ticketsLink = document.querySelector('a[href="/tickets"]');
if (ticketsLink) {
  ticketsLink.addEventListener('click', function(e) {
    e.preventDefault();
    const href = this.getAttribute('href');

    const lang = '<%= lang %>';
    const texts = {
      de: { text: 'Ticket-Verlauf wird geladen...', subtext: 'Bitte warten' },
      en: { text: 'Loading ticket history...', subtext: 'Please wait' },
      he: { text: '◊ò◊ï◊¢◊ü ◊î◊ô◊°◊ò◊ï◊®◊ô◊î...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
      ja: { text: 'Â±•Ê≠¥„ÇíË™≠„ÅøËæº„Åø‰∏≠...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
      ru: { text: '–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
      pt: { text: 'Carregando hist√≥rico...', subtext: 'Por favor, aguarde' },
      es: { text: 'Cargando historial...', subtext: 'Por favor, espere' },
      id: { text: 'Memuat riwayat...', subtext: 'Mohon tunggu' },
      ar: { text: 'ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ≥ÿ¨ŸÑ...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
    };

    const t = texts[lang] || texts.de;
    showLoading(t.text, t.subtext);

    setTimeout(() => {
      window.location.href = href;
    }, 100);
  });
}

// Disable all form elements for non-admin users (team members in read-only mode)
<% if (typeof isAdmin !== 'undefined' && !isAdmin) { %>
(function() {
  // Disable all inputs, textareas, and selects in the main form
  const mainForm = document.getElementById('panelForm');
  if (mainForm) {
    const formElements = mainForm.querySelectorAll('input:not([readonly]), textarea, select');
    formElements.forEach(element => {
      element.disabled = true;
      element.style.cursor = 'not-allowed';
      element.style.opacity = '0.6';
    });

    // Disable all buttons (add/delete buttons)
    const buttons = mainForm.querySelectorAll('button:not([type="submit"])');
    buttons.forEach(button => {
      button.disabled = true;
      button.style.cursor = 'not-allowed';
      button.style.opacity = '0.5';
    });

    // Prevent form submission
    mainForm.addEventListener('submit', function(e) {
      e.preventDefault();
      alert('<%= lang === "de" ? "Du hast keine Berechtigung, Einstellungen zu √§ndern." : lang === "en" ? "You do not have permission to change settings." : lang === "he" ? "◊ê◊ô◊ü ◊ú◊ö ◊î◊®◊©◊ê◊î ◊ú◊©◊†◊ï◊™ ◊î◊í◊ì◊®◊ï◊™." : lang === "ja" ? "Ë®≠ÂÆö„ÇíÂ§âÊõ¥„Åô„ÇãÊ®©Èôê„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ" : lang === "ru" ? "–£ –≤–∞—Å –Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫." : lang === "pt" ? "Voc√™ n√£o tem permiss√£o para alterar as configura√ß√µes." : lang === "es" ? "No tienes permiso para cambiar la configuraci√≥n." : lang === "id" ? "Anda tidak memiliki izin untuk mengubah pengaturan." : lang === "ar" ? "ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ÿ•ÿ∞ŸÜ ŸÑÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™." : "Du hast keine Berechtigung, Einstellungen zu √§ndern." %>');
      return false;
    });
  }
})();
<% } %>
</script>

<!-- Sidebar Toggle Script -->
<script>
function toggleSidebar() {
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('sidebarOverlay');
  const toggleBtn = document.getElementById('sidebarToggle');

  if (sidebar && overlay) {
    const isOpen = sidebar.classList.contains('open');

    if (isOpen) {
      sidebar.classList.remove('open');
      overlay.classList.remove('active');
      toggleBtn.setAttribute('aria-expanded', 'false');
    } else {
      sidebar.classList.add('open');
      overlay.classList.add('active');
      toggleBtn.setAttribute('aria-expanded', 'true');
    }
  }
}

// Close sidebar when clicking outside on mobile
document.addEventListener('DOMContentLoaded', function() {
  const overlay = document.getElementById('sidebarOverlay');
  if (overlay) {
    overlay.addEventListener('click', toggleSidebar);
  }

  // Close sidebar when pressing Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      const sidebar = document.getElementById('sidebar');
      if (sidebar && sidebar.classList.contains('open')) {
        toggleSidebar();
      }
    }
  });
});
</script>

<!-- UX Enhancements -->
<script src="/js/ux-enhancements.js"></script>
</body>
</html>