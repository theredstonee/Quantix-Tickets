<!doctype html>
<html lang="<%= lang %>">
<head>
  <!-- Theme Manager - Load before anything else -->
  <script src="/js/theme-manager.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feedback - Quantix Tickets</title>
  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="shortcut icon" href="/images/favicon.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    :root {
      --bg-color: #f0f8ff;
      --text-color: #1a1a2e;
      --accent-color: #0ea5e9;
      --accent-hover: #0284c7;
      --glass-bg: rgba(240, 248, 255, 0.7);
      --glass-border: rgba(14, 165, 233, 0.3);
      --shadow-color: rgba(14, 165, 233, 0.15);
    }

    [data-theme="dark"] {
      --bg-color: #0a0a0a;
      --text-color: #00ff88;
      --accent-color: #00ff88;
      --accent-hover: #00dd77;
      --glass-bg: rgba(15, 21, 16, 0.7);
      --glass-border: rgba(0, 255, 136, 0.3);
      --shadow-color: rgba(0, 255, 136, 0.2);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      background: radial-gradient(circle, var(--accent-color) 1px, transparent 1px);
      background-size: 50px 50px;
      opacity: 0.03;
      animation: bgMove 20s linear infinite;
    }

    @keyframes bgMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(50px, 50px); }
    }

    .header {
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      border-bottom: 2px solid var(--glass-border);
      padding: 1rem 0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 4px 16px var(--shadow-color);
    }

    .header-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-color);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .nav-links {
      display: flex;
      gap: 1.5rem;
      align-items: center;
    }

    .nav-links a {
      color: var(--text-color);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
    }

    .nav-links a:hover {
      background: var(--glass-bg);
      color: var(--accent-color);
    }

    .theme-toggle {
      background: transparent;
      border: 2px solid var(--glass-border);
      color: var(--text-color);
      cursor: pointer;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 1rem;
      transition: all 0.3s;
    }

    .theme-toggle:hover {
      background: var(--glass-bg);
      border-color: var(--accent-color);
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 4rem 2rem;
    }

    .hero-icon {
      font-size: 4rem;
      text-align: center;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    h1 {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: var(--accent-color);
      font-weight: 700;
    }

    .subtitle {
      text-align: center;
      font-size: 1.1rem;
      opacity: 0.8;
      margin-bottom: 3rem;
      line-height: 1.6;
    }

    .feedback-form {
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      border: 2px solid var(--glass-border);
      border-radius: 1rem;
      padding: 2.5rem;
      box-shadow: 0 8px 32px var(--shadow-color);
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--accent-color);
    }

    input, select, textarea {
      width: 100%;
      padding: 0.75rem;
      background: rgba(0, 0, 0, 0.05);
      border: 2px solid var(--glass-border);
      border-radius: 0.5rem;
      color: var(--text-color);
      font-family: inherit;
      transition: all 0.3s;
    }

    [data-theme="dark"] input,
    [data-theme="dark"] select,
    [data-theme="dark"] textarea {
      background: rgba(255, 255, 255, 0.05);
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(0, 184, 148, 0.1);
    }

    input[readonly] {
      background: rgba(0, 184, 148, 0.05);
      cursor: not-allowed;
      opacity: 0.8;
    }

    textarea {
      min-height: 150px;
      resize: vertical;
    }

    .btn-submit {
      width: 100%;
      padding: 1rem;
      background: var(--accent-color);
      color: #000;
      border: none;
      border-radius: 0.75rem;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-submit:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
      box-shadow: 0 8px 16px var(--shadow-color);
    }

    .alert {
      padding: 1rem;
      border-radius: 0.75rem;
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      font-weight: 500;
    }

    .alert-success {
      background: rgba(0, 184, 148, 0.1);
      border: 2px solid var(--accent-color);
      color: var(--accent-color);
    }

    .alert-error {
      background: rgba(231, 76, 60, 0.1);
      border: 2px solid #e74c3c;
      color: #e74c3c;
    }

    .star-rating {
      display: flex;
      gap: 0.5rem;
      font-size: 2.5rem;
      justify-content: center;
      margin: 1rem 0;
    }

    .star-rating i {
      cursor: pointer;
      color: #ddd;
      transition: all 0.2s;
    }

    [data-theme="dark"] .star-rating i {
      color: rgba(255, 255, 255, 0.2);
    }

    .star-rating i:hover,
    .star-rating i.active {
      color: #f1c40f;
      transform: scale(1.1);
    }

    .star-rating i.active {
      animation: starPulse 0.3s ease;
    }

    @keyframes starPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    /* Loading Overlay */
    #loadingOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #loadingOverlay.show {
      opacity: 1;
      visibility: visible;
    }

    .loading-content {
      text-align: center;
      color: var(--accent-color);
    }

    .loading-spinner {
      font-size: 3rem;
      animation: spin 1s linear infinite;
      margin-bottom: 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .loading-subtext {
      font-size: 1rem;
      opacity: 0.7;
    }

    @media (max-width: 768px) {
      .header-container {
        flex-direction: column;
        gap: 1rem;
      }

      .nav-links {
        flex-direction: column;
        gap: 0.5rem;
      }

      h1 { font-size: 2rem; }

      .feedback-form {
        padding: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-container">
      <a href="/" class="logo">
        <i class="fas fa-ticket-alt"></i>
        Quantix Tickets
      </a>
      <nav class="nav-links">
        <a href="/">
          <i class="fas fa-home"></i> Home
        </a>
        <% if (isAuthenticated && user) { %>
          <a href="/panel">
            <i class="fas fa-tachometer-alt"></i> Dashboard
          </a>
        <% } else { %>
          <a href="/login">
            <i class="fas fa-sign-in-alt"></i> Login
          </a>
        <% } %>
        <button class="theme-toggle" id="themeToggle">
          <i class="fas fa-moon"></i>
        </button>
      </nav>
    </div>
  </header>

  <div class="container">
    <div class="hero-icon">
      <i class="fas fa-comments"></i>
    </div>
    <h1><%
      const titles = {
        de: 'Feedback',
        en: 'Feedback',
        he: '◊û◊©◊ï◊ë',
        ja: '„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ',
        ru: '–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å',
        pt: 'Feedback',
        es: 'Comentarios',
        id: 'Umpan Balik',
        ar: 'ÿ™ÿπŸÑŸäŸÇ'
      };
    %><%= titles[lang] || titles.de %></h1>
    <p class="subtitle"><%
      const subtitles = {
        de: 'Deine Meinung ist uns wichtig! Teile uns mit, was wir verbessern k√∂nnen.',
        en: 'Your opinion matters! Tell us what we can improve.',
        he: '◊ì◊¢◊™◊ö ◊ó◊©◊ï◊ë◊î! ◊°◊§◊® ◊ú◊†◊ï ◊û◊î ◊†◊ï◊õ◊ú ◊ú◊©◊§◊®.',
        ja: '„ÅÇ„Å™„Åü„ÅÆÊÑèË¶ã„ÅØÈáçË¶Å„Åß„ÅôÔºÅÊîπÂñÑ„Åß„Åç„Çã„Åì„Å®„ÇíÊïô„Åà„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
        ru: '–í–∞—à–µ –º–Ω–µ–Ω–∏–µ –≤–∞–∂–Ω–æ! –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –Ω–∞–º, —á—Ç–æ –º—ã –º–æ–∂–µ–º —É–ª—É—á—à–∏—Ç—å.',
        pt: 'Sua opini√£o importa! Diga-nos o que podemos melhorar.',
        es: '¬°Tu opini√≥n importa! Dinos qu√© podemos mejorar.',
        id: 'Pendapat Anda penting! Beritahu kami apa yang dapat kami tingkatkan.',
        ar: 'ÿ±ÿ£ŸäŸÉ ŸÖŸáŸÖ! ÿ£ÿÆÿ®ÿ±ŸÜÿß ÿ®ŸÖÿß ŸäŸÖŸÉŸÜŸÜÿß ÿ™ÿ≠ÿ≥ŸäŸÜŸá.'
      };
    %><%= subtitles[lang] || subtitles.de %></p>

    <% if (success) { %>
      <div class="alert alert-success">
        <i class="fas fa-check-circle" style="font-size: 1.5rem;"></i>
        <div>
          <strong><%
            const successTitle = {
              de: 'Vielen Dank!',
              en: 'Thank you!',
              he: '◊™◊ï◊ì◊î ◊®◊ë◊î!',
              ja: '„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ',
              ru: '–°–ø–∞—Å–∏–±–æ!',
              pt: 'Obrigado!',
              es: '¬°Gracias!',
              id: 'Terima kasih!',
              ar: 'ÿ¥ŸÉÿ±Ÿãÿß ŸÑŸÉ!'
            };
          %><%= successTitle[lang] || successTitle.de %></strong><br>
          <%
            const successMsg = {
              de: 'Dein Feedback wurde erfolgreich √ºbermittelt.',
              en: 'Your feedback has been successfully submitted.',
              he: '◊î◊û◊©◊ï◊ë ◊©◊ú◊ö ◊†◊©◊ú◊ó ◊ë◊î◊¶◊ú◊ó◊î.',
              ja: '„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ„ÅåÊ≠£Â∏∏„Å´ÈÄÅ‰ø°„Åï„Çå„Åæ„Åó„Åü„ÄÇ',
              ru: '–í–∞—à –æ—Ç–∑—ã–≤ –±—ã–ª —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω.',
              pt: 'Seu feedback foi enviado com sucesso.',
              es: 'Tu comentario ha sido enviado exitosamente.',
              id: 'Umpan balik Anda telah berhasil dikirim.',
              ar: 'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ™ÿπŸÑŸäŸÇŸÉ ÿ®ŸÜÿ¨ÿßch.'
            };
          %><%= successMsg[lang] || successMsg.de %>
        </div>
      </div>
    <% } %>

    <% if (error) { %>
      <div class="alert alert-error">
        <i class="fas fa-exclamation-circle" style="font-size: 1.5rem;"></i>
        <div>
          <strong><%
            const errorTitle = {
              de: 'Fehler!',
              en: 'Error!',
              he: '◊©◊í◊ô◊ê◊î!',
              ja: '„Ç®„É©„ÉºÔºÅ',
              ru: '–û—à–∏–±–∫–∞!',
              pt: 'Erro!',
              es: '¬°Error!',
              id: 'Kesalahan!',
              ar: 'ÿÆÿ∑ÿ£!'
            };
          %><%= errorTitle[lang] || errorTitle.de %></strong><br>
          <%
            const errorMsg = {
              de: 'Bitte f√ºlle alle Felder aus.',
              en: 'Please fill in all fields.',
              he: '◊ê◊†◊ê ◊û◊ú◊ê ◊ê◊™ ◊õ◊ú ◊î◊©◊ì◊ï◊™.',
              ja: '„Åô„Åπ„Å¶„ÅÆ„Éï„Ç£„Éº„É´„Éâ„Å´ÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
              ru: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è.',
              pt: 'Por favor, preencha todos os campos.',
              es: 'Por favor, completa todos los campos.',
              id: 'Silakan isi semua kolom.',
              ar: 'Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ.'
            };
          %><%= errorMsg[lang] || errorMsg.de %>
        </div>
      </div>
    <% } %>

    <% if (isAuthenticated && user) { %>
      <div class="form-group" style="background: rgba(0, 184, 148, 0.05); padding: 1.5rem; border-radius: 0.75rem; border: 2px solid var(--glass-border); margin-bottom: 1.5rem;">
        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
          <img src="https://cdn.discordapp.com/avatars/<%= user.id %>/<%= user.avatar %>.png"
               alt="Avatar"
               style="width: 48px; height: 48px; border-radius: 50%; border: 2px solid var(--accent-color);"
               onerror="this.src='https://cdn.discordapp.com/embed/avatars/0.png'">
          <div>
            <div style="font-weight: 600; font-size: 1.1rem; color: var(--accent-color);">
              <%= user.username %>
            </div>
            <div style="font-size: 0.85rem; opacity: 0.7;">
              <%
                const discordAccountText = {
                  de: 'Mit Discord-Account verkn√ºpft',
                  en: 'Linked with Discord account',
                  he: '◊û◊ß◊ï◊©◊® ◊ú◊ó◊©◊ë◊ï◊ü Discord',
                  ja: 'Discord„Ç¢„Ç´„Ç¶„É≥„Éà„Å®ÈÄ£Êê∫Ê∏à„Åø',
                  ru: '–°–≤—è–∑–∞–Ω–æ —Å –∞–∫–∫–∞—É–Ω—Ç–æ–º Discord',
                  pt: 'Vinculado √† conta do Discord',
                  es: 'Vinculado a la cuenta de Discord',
                  id: 'Terhubung dengan akun Discord',
                  ar: 'ŸÖÿ±ÿ™ÿ®ÿ∑ ÿ®ÿ≠ÿ≥ÿßÿ® Discord'
                };
              %><%= discordAccountText[lang] || discordAccountText.de %>
            </div>
          </div>
        </div>
      </div>
    <% } %>

    <form class="feedback-form" method="POST" action="/feedback">
      <div class="form-group">
        <label><%
          const nameLabel = {
            de: 'Name',
            en: 'Name',
            he: '◊©◊ù',
            ja: 'ÂêçÂâç',
            ru: '–ò–º—è',
            pt: 'Nome',
            es: 'Nombre',
            id: 'Nama',
            ar: 'ÿßŸÑÿßÿ≥ŸÖ'
          };
        %><%= nameLabel[lang] || nameLabel.de %> *</label>
        <input type="text" name="name" required value="<%= isAuthenticated && user ? user.username : '' %>" <%= isAuthenticated && user ? 'readonly' : '' %>>
      </div>

      <div class="form-group">
        <label><%
          const emailLabel = {
            de: 'E-Mail (Optional)',
            en: 'Email (Optional)',
            he: '◊ì◊ï◊ê"◊ú (◊ê◊ï◊§◊¶◊ô◊ï◊†◊ú◊ô)',
            ja: '„É°„Éº„É´Ôºà‰ªªÊÑèÔºâ',
            ru: 'Email (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)',
            pt: 'E-mail (Opcional)',
            es: 'Correo electr√≥nico (Opcional)',
            id: 'Email (Opsional)',
            ar: 'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)'
          };
        %><%= emailLabel[lang] || emailLabel.de %></label>
        <input type="email" name="email" placeholder="<%
          const emailPlaceholder = {
            de: 'Optional - f√ºr R√ºckmeldung',
            en: 'Optional - for follow-up',
            he: '◊ê◊ï◊§◊¶◊ô◊ï◊†◊ú◊ô - ◊ú◊û◊¢◊ß◊ë',
            ja: '„Ç™„Éó„Ç∑„Éß„É≥ - „Éï„Ç©„É≠„Éº„Ç¢„ÉÉ„ÉóÁî®',
            ru: '–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ - –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏',
            pt: 'Opcional - para acompanhamento',
            es: 'Opcional - para seguimiento',
            id: 'Opsional - untuk tindak lanjut',
            ar: 'ÿßÿÆÿ™Ÿäÿßÿ±Ÿä - ŸÑŸÑŸÖÿ™ÿßÿ®ÿπÿ©'
          };
        %><%= emailPlaceholder[lang] || emailPlaceholder.de %>">
      </div>

      <div class="form-group">
        <label><%
          const typeLabel = {
            de: 'Typ',
            en: 'Type',
            he: '◊°◊ï◊í',
            ja: '„Çø„Ç§„Éó',
            ru: '–¢–∏–ø',
            pt: 'Tipo',
            es: 'Tipo',
            id: 'Jenis',
            ar: 'ÿßŸÑŸÜŸàÿπ'
          };
        %><%= typeLabel[lang] || typeLabel.de %> *</label>
        <select name="type" id="feedbackType" required>
          <option value=""><%
            const selectOption = {
              de: '-- Bitte w√§hlen --',
              en: '-- Please select --',
              he: '-- ◊ê◊†◊ê ◊ë◊ó◊® --',
              ja: '-- ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ --',
              ru: '-- –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ --',
              pt: '-- Por favor, selecione --',
              es: '-- Por favor, selecciona --',
              id: '-- Silakan pilih --',
              ar: '-- Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ± --'
            };
          %><%= selectOption[lang] || selectOption.de %></option>
          <option value="bug">üêõ <%
            const bugOption = {
              de: 'Bug-Bericht',
              en: 'Bug Report',
              he: '◊ì◊ô◊ï◊ï◊ó ◊¢◊ú ◊ë◊ê◊í',
              ja: '„Éê„Ç∞„É¨„Éù„Éº„Éà',
              ru: '–û—Ç—á–µ—Ç –æ–± –æ—à–∏–±–∫–µ',
              pt: 'Relat√≥rio de Bug',
              es: 'Reporte de Error',
              id: 'Laporan Bug',
              ar: 'ÿ™ŸÇÿ±Ÿäÿ± ÿÆÿ∑ÿ£'
            };
          %><%= bugOption[lang] || bugOption.de %></option>
          <option value="feature">‚ú® <%
            const featureOption = {
              de: 'Feature-Wunsch',
              en: 'Feature Request',
              he: '◊ë◊ß◊©◊™ ◊™◊õ◊ï◊†◊î',
              ja: 'Ê©üËÉΩ„É™„ÇØ„Ç®„Çπ„Éà',
              ru: '–ó–∞–ø—Ä–æ—Å —Ñ—É–Ω–∫—Ü–∏–∏',
              pt: 'Solicita√ß√£o de Recurso',
              es: 'Solicitud de Funci√≥n',
              id: 'Permintaan Fitur',
              ar: 'ÿ∑ŸÑÿ® ŸÖŸäÿ≤ÿ©'
            };
          %><%= featureOption[lang] || featureOption.de %></option>
          <option value="improvement">üöÄ <%
            const improvementOption = {
              de: 'Verbesserungsvorschlag',
              en: 'Improvement Suggestion',
              he: '◊î◊¶◊¢◊™ ◊©◊ô◊§◊ï◊®',
              ja: 'ÊîπÂñÑÊèêÊ°à',
              ru: '–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é',
              pt: 'Sugest√£o de Melhoria',
              es: 'Sugerencia de Mejora',
              id: 'Saran Perbaikan',
              ar: 'ÿßŸÇÿ™ÿ±ÿßÿ≠ ÿ™ÿ≠ÿ≥ŸäŸÜ'
            };
          %><%= improvementOption[lang] || improvementOption.de %></option>
          <option value="general">üìù <%
            const generalOption = {
              de: 'Allgemeines Feedback',
              en: 'General Feedback',
              he: '◊û◊©◊ï◊ë ◊õ◊ú◊ú◊ô',
              ja: '‰∏ÄËà¨ÁöÑ„Å™„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ',
              ru: '–û–±—â–∏–π –æ—Ç–∑—ã–≤',
              pt: 'Feedback Geral',
              es: 'Comentario General',
              id: 'Umpan Balik Umum',
              ar: 'ÿ™ÿπŸÑŸäŸÇ ÿπÿßŸÖ'
            };
          %><%= generalOption[lang] || generalOption.de %></option>
          <option value="other">üí¨ <%
            const otherOption = {
              de: 'Sonstiges',
              en: 'Other',
              he: '◊ê◊ó◊®',
              ja: '„Åù„ÅÆ‰ªñ',
              ru: '–î—Ä—É–≥–æ–µ',
              pt: 'Outro',
              es: 'Otro',
              id: 'Lainnya',
              ar: 'ÿ¢ÿÆÿ±'
            };
          %><%= otherOption[lang] || otherOption.de %></option>
        </select>
      </div>

      <div class="form-group" id="ratingGroup" style="display: none;">
        <label><%
          const ratingLabel = {
            de: 'Bewertung',
            en: 'Rating',
            he: '◊ì◊ô◊®◊ï◊í',
            ja: 'Ë©ï‰æ°',
            ru: '–†–µ–π—Ç–∏–Ω–≥',
            pt: 'Avalia√ß√£o',
            es: 'Calificaci√≥n',
            id: 'Penilaian',
            ar: 'ÿ™ŸÇŸäŸäŸÖ'
          };
        %><%= ratingLabel[lang] || ratingLabel.de %> *</label>
        <div class="star-rating" id="starRating">
          <i class="far fa-star" data-rating="1"></i>
          <i class="far fa-star" data-rating="2"></i>
          <i class="far fa-star" data-rating="3"></i>
          <i class="far fa-star" data-rating="4"></i>
          <i class="far fa-star" data-rating="5"></i>
        </div>
        <input type="hidden" name="rating" id="ratingInput" value="">
      </div>

      <div class="form-group">
        <label><%
          const messageLabel = {
            de: 'Nachricht',
            en: 'Message',
            he: '◊î◊ï◊ì◊¢◊î',
            ja: '„É°„ÉÉ„Çª„Éº„Ç∏',
            ru: '–°–æ–æ–±—â–µ–Ω–∏–µ',
            pt: 'Mensagem',
            es: 'Mensaje',
            id: 'Pesan',
            ar: 'ÿ±ÿ≥ÿßŸÑÿ©'
          };
        %><%= messageLabel[lang] || messageLabel.de %> *</label>
        <textarea name="message" required placeholder="<%
          const messagePlaceholder = {
            de: 'Beschreibe dein Anliegen so detailliert wie m√∂glich...',
            en: 'Describe your concern in as much detail as possible...',
            he: '◊™◊ê◊® ◊ê◊™ ◊î◊†◊ï◊©◊ê ◊©◊ú◊ö ◊ë◊§◊ô◊®◊ï◊ò ◊®◊ë ◊õ◊õ◊ú ◊î◊ê◊§◊©◊®...',
            ja: '„Åß„Åç„Çã„Å†„ÅëË©≥„Åó„Åè„ÅäÁü•„Çâ„Åõ„Åè„Å†„Åï„ÅÑ...',
            ru: '–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É –∫–∞–∫ –º–æ–∂–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–µ–µ...',
            pt: 'Descreva sua preocupa√ß√£o com o m√°ximo de detalhes poss√≠vel...',
            es: 'Describe tu inquietud con el mayor detalle posible...',
            id: 'Jelaskan masalah Anda sedetail mungkin...',
            ar: 'ÿµŸÅ ŸÖÿ¥ŸÉŸÑÿ™ŸÉ ÿ®ÿ£ŸÉÿ®ÿ± ŸÇÿØÿ± ŸÖŸÖŸÉŸÜ ŸÖŸÜ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ...'
          };
        %><%= messagePlaceholder[lang] || messagePlaceholder.de %>"></textarea>
      </div>

      <button type="submit" class="btn-submit">
        <i class="fas fa-paper-plane"></i>
        <%
          const submitButton = {
            de: 'Feedback senden',
            en: 'Send Feedback',
            he: '◊©◊ú◊ó ◊û◊©◊ï◊ë',
            ja: '„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ„ÇíÈÄÅ‰ø°',
            ru: '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤',
            pt: 'Enviar Feedback',
            es: 'Enviar Comentarios',
            id: 'Kirim Umpan Balik',
            ar: 'ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ™ÿπŸÑŸäŸÇÿßÿ™'
          };
        %><%= submitButton[lang] || submitButton.de %>
      </button>
    </form>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-spinner">
        <i class="fas fa-spinner"></i>
      </div>
      <div class="loading-text" id="loadingText">L√§dt...</div>
      <div class="loading-subtext">Bitte warten</div>
    </div>
  </div>

  <script>
    // Theme is managed by /js/theme-manager.js (Cookie-based)

    // Show/hide rating based on feedback type
    const feedbackTypeSelect = document.getElementById('feedbackType');
    const ratingGroup = document.getElementById('ratingGroup');
    const ratingInput = document.getElementById('ratingInput');

    feedbackTypeSelect.addEventListener('change', function() {
      if (this.value === 'general') {
        ratingGroup.style.display = 'block';
        ratingInput.setAttribute('required', 'required');
      } else {
        ratingGroup.style.display = 'none';
        ratingInput.removeAttribute('required');
        ratingInput.value = '0'; // Set to 0 for non-general feedback
        selectedRating = 0;
        updateStars(0);
      }
    });

    // Star Rating System
    const stars = document.querySelectorAll('.star-rating i');
    let selectedRating = 0;

    stars.forEach(star => {
      star.addEventListener('click', function() {
        selectedRating = parseInt(this.getAttribute('data-rating'));
        ratingInput.value = selectedRating;
        updateStars(selectedRating);
      });

      star.addEventListener('mouseenter', function() {
        const hoverRating = parseInt(this.getAttribute('data-rating'));
        updateStars(hoverRating);
      });
    });

    document.getElementById('starRating').addEventListener('mouseleave', function() {
      updateStars(selectedRating);
    });

    function updateStars(rating) {
      stars.forEach((star, index) => {
        if (index < rating) {
          star.className = 'fas fa-star active';
        } else {
          star.className = 'far fa-star';
        }
      });
    }

    // Form validation
    document.querySelector('.feedback-form').addEventListener('submit', function(e) {
      const nameInput = this.querySelector('input[name="name"]');
      const typeInput = this.querySelector('select[name="type"]');
      const messageInput = this.querySelector('textarea[name="message"]');

      // Basic validation
      if (!nameInput.value.trim() || !typeInput.value || !messageInput.value.trim()) {
        e.preventDefault();
        alert('<%
          const requiredMsg = {
            de: "Bitte f√ºlle alle Pflichtfelder aus!",
            en: "Please fill in all required fields!",
            he: "◊ê◊†◊ê ◊û◊ú◊ê ◊ê◊™ ◊õ◊ú ◊î◊©◊ì◊ï◊™ ◊î◊†◊ì◊®◊©◊ô◊ù!",
            ja: "„Åô„Åπ„Å¶„ÅÆÂøÖÈ†à„Éï„Ç£„Éº„É´„Éâ„Å´ÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºÅ",
            ru: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!",
            pt: "Por favor, preencha todos os campos obrigat√≥rios!",
            es: "¬°Por favor, completa todos los campos obligatorios!",
            id: "Silakan isi semua kolom yang wajib!",
            ar: "Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©!"
          };
        %><%= requiredMsg[lang] || requiredMsg.de %>');
        return;
      }

      // Rating validation (only for general feedback)
      if (typeInput.value === 'general' && (!ratingInput.value || ratingInput.value === '0')) {
        e.preventDefault();
        alert('<%
          const alertMsg = {
            de: "Bitte gib eine Bewertung ab!",
            en: "Please select a rating!",
            he: "◊ê◊†◊ê ◊ë◊ó◊® ◊ì◊ô◊®◊ï◊í!",
            ja: "Ë©ï‰æ°„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºÅ",
            ru: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–π—Ç–∏–Ω–≥!",
            pt: "Por favor, selecione uma avalia√ß√£o!",
            es: "¬°Por favor, selecciona una calificaci√≥n!",
            id: "Silakan pilih penilaian!",
            ar: "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿßÿÆÿ™Ÿäÿßÿ± ÿ™ŸÇŸäŸäŸÖ!"
          };
        %><%= alertMsg[lang] || alertMsg.de %>');
      }
    });

    // Loading Animations
    function showLoading(text, subtext) {
      const overlay = document.getElementById('loadingOverlay');
      const loadingText = document.getElementById('loadingText');
      const loadingSubtext = overlay.querySelector('.loading-subtext');

      loadingText.textContent = text;
      if (subtext) {
        loadingSubtext.textContent = subtext;
      }
      overlay.classList.add('show');
    }

    // Add loading animations to navigation links
    const lang = '<%= lang %>';

    // Home link
    const homeLink = document.querySelector('a[href="/"]');
    if (homeLink) {
      homeLink.addEventListener('click', function(e) {
        e.preventDefault();
        const href = this.getAttribute('href');
        const texts = {
          de: { text: 'Zur√ºck zur Startseite...', subtext: 'Bitte warten' },
          en: { text: 'Back to homepage...', subtext: 'Please wait' },
          he: { text: '◊ó◊ñ◊®◊î ◊ú◊ì◊£ ◊î◊ë◊ô◊™...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
          ja: { text: '„Éõ„Éº„É†„Éö„Éº„Ç∏„Å´Êàª„Çã...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
          ru: { text: '–í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
          pt: { text: 'Voltar √† p√°gina inicial...', subtext: 'Aguarde' },
          es: { text: 'Volver a la p√°gina de inicio...', subtext: 'Espere' },
          id: { text: 'Kembali ke beranda...', subtext: 'Mohon tunggu' },
          ar: { text: 'ÿßŸÑÿπŸàÿØÿ© ÿ•ŸÑŸâ ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
        };
        const t = texts[lang] || texts.de;
        showLoading(t.text, t.subtext);
        setTimeout(() => {
          window.location.href = href;
        }, 100);
      });
    }

    // Dashboard/Panel link
    const panelLink = document.querySelector('a[href="/panel"]');
    if (panelLink) {
      panelLink.addEventListener('click', function(e) {
        e.preventDefault();
        const href = this.getAttribute('href');
        const texts = {
          de: { text: 'Dashboard wird geladen...', subtext: 'Bitte warten' },
          en: { text: 'Loading dashboard...', subtext: 'Please wait' },
          he: { text: '◊ò◊ï◊¢◊ü ◊ú◊ï◊ó ◊ë◊ß◊®◊î...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
          ja: { text: '„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÇíË™≠„ÅøËæº„Çì„Åß„ÅÑ„Åæ„Åô...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
          ru: { text: '–ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞–Ω–µ–ª–∏...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
          pt: { text: 'Carregando painel...', subtext: 'Aguarde' },
          es: { text: 'Cargando panel...', subtext: 'Espere' },
          id: { text: 'Memuat panel...', subtext: 'Mohon tunggu' },
          ar: { text: 'ÿ™ÿ≠ŸÖŸäŸÑ ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
        };
        const t = texts[lang] || texts.de;
        showLoading(t.text, t.subtext);
        setTimeout(() => {
          window.location.href = href;
        }, 100);
      });
    }

    // Login link
    const loginLink = document.querySelector('a[href="/login"]');
    if (loginLink) {
      loginLink.addEventListener('click', function(e) {
        e.preventDefault();
        const href = this.getAttribute('href');
        const texts = {
          de: { text: 'Weiterleitung zum Login...', subtext: 'Bitte warten' },
          en: { text: 'Redirecting to login...', subtext: 'Please wait' },
          he: { text: '◊û◊§◊†◊î ◊ú◊î◊™◊ó◊ë◊®◊ï◊™...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
          ja: { text: '„É≠„Ç∞„Ç§„É≥„Éö„Éº„Ç∏„Å´„É™„ÉÄ„Ç§„É¨„ÇØ„Éà...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
          ru: { text: '–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –≤—Ö–æ–¥...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
          pt: { text: 'Redirecionando para login...', subtext: 'Aguarde' },
          es: { text: 'Redirigiendo al inicio de sesi√≥n...', subtext: 'Espere' },
          id: { text: 'Mengalihkan ke login...', subtext: 'Mohon tunggu' },
          ar: { text: 'ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá ÿ•ŸÑŸâ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
        };
        const t = texts[lang] || texts.de;
        showLoading(t.text, t.subtext);
        setTimeout(() => {
          window.location.href = href;
        }, 100);
      });
    }
  </script>
</body>
</html>
