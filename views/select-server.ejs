<!doctype html>
<html lang="de" data-theme="light">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SLMX16ZJ6Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-SLMX16ZJ6Y');
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <title>Server Auswahl - TRS Tickets</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="shortcut icon" href="/images/favicon.png">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="/markdown.css">
  <style>
    :root {
      --bg-color: #fff;
      --text-color: #1a1a1a;
      --border-color: #e5e8ec;
      --accent-color: #00b894;
      --accent-hover: #00a077;
      --card-bg: #fff;
      --card-hover-shadow: rgba(0,255,0,0.1);
      --icon-bg: #e5e8ec;
      --badge-bg: #00ff00;
      --glass-bg: rgba(255, 255, 255, 0.7);
      --glass-border: rgba(255, 255, 255, 0.3);
      --shadow-color: rgba(0, 0, 0, 0.1);
    }

    [data-theme="dark"] {
      --bg-color: #0a0a0a;
      --text-color: #00ff88;
      --border-color: #1a3a2a;
      --accent-color: #00ff88;
      --accent-hover: #00dd77;
      --card-bg: #0f1510;
      --card-hover-shadow: rgba(0,255,136,0.2);
      --icon-bg: #1a3a2a;
      --badge-bg: #00ff88;
      --glass-bg: rgba(15, 21, 16, 0.7);
      --glass-border: rgba(0, 255, 136, 0.3);
      --shadow-color: rgba(0, 255, 136, 0.2);
    }

    [data-theme="dark"] body {
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    [data-theme="dark"] .server-card {
      background: var(--card-bg);
      border-color: var(--border-color);
    }

    [data-theme="dark"] .server-card:hover {
      border-color: var(--accent-color);
      box-shadow: 0 4px 12px var(--card-hover-shadow);
    }

    [data-theme="dark"] .server-card.selected {
      border-color: var(--accent-color);
      background: var(--card-bg);
    }

    [data-theme="dark"] .server-icon {
      background: var(--icon-bg);
    }

    [data-theme="dark"] .current-badge {
      background: var(--badge-bg);
      color: #000;
    }

    [data-theme="dark"] button:not(.theme-toggle) {
      background: var(--accent-color);
      color: #000;
    }

    /* Animated Background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: radial-gradient(circle, var(--accent-color) 1px, transparent 1px);
      background-size: 50px 50px;
      opacity: 0.03;
      animation: bgMove 20s linear infinite;
    }

    @keyframes bgMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(50px, 50px); }
    }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      width: 100%;
      max-width: 100%;
      padding: 0 2rem;
      line-height: 1.8;
      margin: 0;
    }

    main {
      width: 100%;
      margin: 0;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      body {
        padding: 0 1rem;
      }

      h1 { font-size: 1.8rem; }

      .sub {
        font-size: 0.85rem !important;
      }

      .server-grid {
        grid-template-columns: 1fr !important;
        gap: 1rem !important;
      }

      .server-card {
        padding: 1.5rem !important;
      }

      .server-icon {
        width: 48px !important;
        height: 48px !important;
      }

      .server-name {
        font-size: 1rem !important;
        flex-wrap: wrap;
      }

      .current-badge {
        font-size: 0.65rem !important;
        padding: 0.15rem 0.4rem !important;
        margin-left: 0 !important;
        margin-top: 0.3rem;
      }

      .server-id {
        font-size: 0.7rem !important;
      }

      .submit-btn {
        width: 100% !important;
      }

      .theme-toggle {
        top: 0.5rem !important;
        right: 0.5rem !important;
        width: 2.5rem !important;
        height: 2.5rem !important;
        font-size: 1.2rem !important;
      }

      .settings-toggle {
        top: 0.5rem !important;
        right: 3.5rem !important;
        width: 2.5rem !important;
        height: 2.5rem !important;
        font-size: 1.2rem !important;
      }

      .no-servers {
        padding: 2rem !important;
        font-size: 0.9rem;
      }
    }

    /* Tablet Responsive */
    @media (min-width: 769px) and (max-width: 1024px) {
      body {
        padding: 0 2rem;
      }

      .server-grid {
        grid-template-columns: repeat(2, 1fr) !important;
      }
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    h1 { display: flex; align-items: center; gap: 0.8rem; margin-bottom: 0.5rem; margin-top: 2rem; }
    .sub { font-size: 0.9rem; opacity: 0.7; margin: 0 0 3rem; }
    .server-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 3rem; }
    .server-card {
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 2px solid var(--glass-border);
      border-radius: 12px;
      padding: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      box-shadow: 0 8px 32px var(--shadow-color);
    }
    .server-card:hover {
      border-color: var(--accent-color);
      box-shadow: 0 12px 40px var(--shadow-color);
      transform: translateY(-4px);
    }
    .server-card.selected {
      border-color: var(--accent-color);
      background: var(--glass-bg);
      box-shadow: 0 12px 40px var(--shadow-color);
    }
    .server-card input[type="radio"] { position: absolute; opacity: 0; }
    .server-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem; }
    .server-icon { width: 48px; height: 48px; border-radius: 50%; background: #e5e8ec; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
    .server-icon img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
    .server-name { font-weight: 600; font-size: 1.1rem; }
    .server-id { font-size: 0.75rem; opacity: 0.6; font-family: monospace; }
    .current-badge { display: inline-block; background: #00ff00; color: #000; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.7rem; font-weight: 600; margin-left: 0.5rem; }
    .no-servers { text-align: center; padding: 3rem; opacity: 0.6; }

    /* No Servers Hero Section */
    .no-servers-hero {
      text-align: center;
      max-width: 800px;
      margin: 0 auto;
      padding: 3rem 2rem;
    }

    .no-servers-icon {
      font-size: 6rem;
      margin-bottom: 2rem;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .no-servers-title {
      font-size: 2.5rem;
      color: var(--accent-color);
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .no-servers-desc {
      font-size: 1.1rem;
      opacity: 0.8;
      margin-bottom: 3rem;
      line-height: 1.6;
    }

    .no-servers-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-bottom: 4rem;
      flex-wrap: wrap;
    }

    .btn-invite {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem 2.5rem;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      color: #000;
      text-decoration: none;
      border-radius: 0.75rem;
      font-size: 1.1rem;
      font-weight: 700;
      box-shadow: 0 8px 32px var(--shadow-color);
      transition: all 0.3s;
    }

    .btn-invite:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 40px var(--shadow-color);
    }

    .btn-secondary {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem 2.5rem;
      background: transparent;
      border: 2px solid var(--glass-border);
      color: var(--text-color);
      text-decoration: none;
      border-radius: 0.75rem;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s;
    }

    .btn-secondary:hover {
      background: var(--glass-bg);
      border-color: var(--accent-color);
      transform: translateY(-3px);
    }

    .no-servers-steps {
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 2px solid var(--glass-border);
      border-radius: 1rem;
      padding: 2rem;
      text-align: left;
      box-shadow: 0 8px 32px var(--shadow-color);
    }

    .no-servers-steps h3 {
      color: var(--accent-color);
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .steps-list {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .step-item {
      display: flex;
      gap: 1.5rem;
      align-items: flex-start;
    }

    .step-num {
      width: 40px;
      height: 40px;
      min-width: 40px;
      background: var(--accent-color);
      color: #000;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.25rem;
    }

    .step-content {
      flex: 1;
    }

    .step-content strong {
      display: block;
      color: var(--accent-color);
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }

    .step-content p {
      opacity: 0.8;
      line-height: 1.6;
      margin: 0;
    }

    @media (max-width: 768px) {
      .no-servers-hero {
        padding: 2rem 1rem;
      }

      .no-servers-icon {
        font-size: 4rem;
      }

      .no-servers-title {
        font-size: 1.75rem;
      }

      .no-servers-desc {
        font-size: 1rem;
      }

      .no-servers-actions {
        flex-direction: column;
      }

      .btn-invite,
      .btn-secondary {
        width: 100%;
        justify-content: center;
      }

      .no-servers-steps {
        padding: 1.5rem;
      }

      .step-item {
        gap: 1rem;
      }

      .step-num {
        width: 32px;
        height: 32px;
        min-width: 32px;
        font-size: 1rem;
      }

      .step-content strong {
        font-size: 1rem;
      }

      .step-content p {
        font-size: 0.9rem;
      }
    }
    .submit-btn { margin-top: 1rem; }
    footer { margin-top: 3rem; margin-bottom: 3rem; padding-bottom: 2rem; text-align: center; font-size: 0.75rem; opacity: 0.6; }

    [data-theme="dark"] footer {
      margin-bottom: 4rem;
      padding-bottom: 3rem;
    }

    /* Loading Overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.95);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      flex-direction: column;
      gap: 2rem;
    }

    .loading-overlay.show {
      display: flex;
    }

    .loading-content {
      text-align: center;
      background: rgba(255,255,255,0.05);
      padding: 3rem;
      border-radius: 20px;
      border: 1px solid rgba(0,255,136,0.2);
      max-width: 400px;
      width: 90%;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 6px solid rgba(0,255,136,100);
      border-top: 6px solid var(--accent-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 2rem;
    }

    .loading-text {
      font-size: 1.3rem;
      color: var(--accent-color);
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .loading-subtext {
      font-size: 0.9rem;
      opacity: 0.7;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .theme-toggle {
      position: fixed;
      top: 1.5rem;
      right: 1.5rem;
      background: var(--accent-color);
      color: #000;
      border: 0;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      z-index: 1000;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
      background: var(--accent-hover);
    }

    [data-theme="dark"] .theme-toggle {
      background: var(--accent-color);
      box-shadow: 0 2px 12px rgba(0,255,136,0.4);
    }

    .settings-toggle {
      position: fixed;
      top: 1.5rem;
      right: 5rem;
      background: var(--accent-color);
      color: #000;
      border: 0;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      z-index: 1000;
    }

    .settings-toggle:hover {
      transform: scale(1.1);
      background: var(--accent-hover);
    }

    .settings-toggle.active {
      animation: spinButton 2s linear infinite;
    }

    [data-theme="dark"] .settings-toggle {
      background: var(--accent-color);
      box-shadow: 0 2px 12px rgba(0,255,136,0.4);
    }

    @keyframes spinButton {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes spinPage {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    body.spinning {
      animation: spinPage 3s linear infinite;
      transform-origin: center center;
      overflow: hidden;
    }

    .nav-buttons {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    .nav-buttons a {
      padding: 0.6rem 1.2rem;
      background: var(--accent-color);
      color: #000;
      text-decoration: none;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      border: 2px solid transparent;
    }

    .nav-buttons a:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,184,148,0.3);
    }

    [data-theme="dark"] .nav-buttons a {
      background: var(--accent-color);
      color: #000;
    }

    [data-theme="dark"] .nav-buttons a:hover {
      background: var(--accent-hover);
      box-shadow: 0 4px 12px rgba(0,255,136,0.4);
    }

    .owner-dashboard-btn.loading {
      pointer-events: none;
      opacity: 0.7;
    }

    .owner-dashboard-btn.loading i {
      animation: spin 1s linear infinite;
    }

    @media (max-width: 768px) {
      .nav-buttons {
        flex-direction: column;
      }

      .nav-buttons a {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <button class="settings-toggle" onclick="toggleSpin()" title="Einstellungen" id="settingsBtn">
    <i class="fas fa-cog"></i>
  </button>
  <button class="theme-toggle" onclick="toggleTheme()" title="Dark Mode umschalten">
    <i id="themeIcon" class="fas fa-moon"></i>
  </button>
  <h1><i class="fas fa-server"></i> <%= t.web.server_selection %></h1>
  <p class="sub"><%= t.web.select_server %></p>

  <div class="nav-buttons">
    <a href="/">
      <i class="fas fa-home"></i> <%= lang === 'de' ? 'Zur Startseite' : lang === 'en' ? 'Back to Home' : lang === 'he' ? '◊ó◊ñ◊®◊î ◊ú◊ì◊£ ◊î◊ë◊ô◊™' : lang === 'ja' ? '„Éõ„Éº„É†„Å´Êàª„Çã' : lang === 'ru' ? '–ù–∞ –≥–ª–∞–≤–Ω—É—é' : lang === 'pt' ? 'Voltar ao In√≠cio' : lang === 'es' ? 'Volver al Inicio' : lang === 'id' ? 'Kembali ke Beranda' : lang === 'zh' ? 'ËøîÂõûÈ¶ñÈ°µ' : lang === 'ar' ? 'ÿßŸÑÿπŸàÿØÿ© ÿ•ŸÑŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©' : 'Zur Startseite' %>
    </a>
    <% if (user && (user.id === '928901974106202113' || user.id === '1159182333316968530')) { %>
      <a href="/owner" id="ownerDashboardBtn" class="owner-dashboard-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); box-shadow: 0 4px 12px rgba(102,126,234,0.4);">
        <i class="fas fa-crown"></i> <%= lang === 'de' ? 'Owner Dashboard' : lang === 'en' ? 'Owner Dashboard' : lang === 'he' ? '◊ú◊ï◊ó ◊ë◊ß◊®◊™ ◊î◊ë◊¢◊ú◊ô◊ù' : lang === 'ja' ? '„Ç™„Éº„Éä„Éº„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ' : lang === 'ru' ? '–ü–∞–Ω–µ–ª—å –≤–ª–∞–¥–µ–ª—å—Ü–∞' : lang === 'pt' ? 'Painel do Propriet√°rio' : lang === 'es' ? 'Panel del Propietario' : lang === 'id' ? 'Panel Pemilik' : lang === 'zh' ? 'ÊâÄÊúâËÄÖ‰ª™Ë°®Êùø' : lang === 'ar' ? 'ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖÿßŸÑŸÉ' : 'Owner Dashboard' %>
      </a>
    <% } %>
  </div>

  <% if (servers && servers.length > 0) { %>
    <form method="POST" action="/select-server" id="serverForm">
      <div class="server-grid">
        <% servers.forEach(server => { %>
          <label class="server-card <%= currentGuild === server.id ? 'selected' : '' %>">
            <input type="radio" name="guildId" value="<%= server.id %>" <%= currentGuild === server.id ? 'checked' : '' %> required>
            <div class="server-header">
              <div class="server-icon">
                <% if (server.icon) { %>
                  <img src="<%= server.icon %>" alt="<%= server.name %>">
                <% } else { %>
                  üõ°Ô∏è
                <% } %>
              </div>
              <div>
                <div class="server-name">
                  <%= server.name %>
                  <% if (currentGuild === server.id) { %>
                    <span class="current-badge"><%= t.web.current %></span>
                  <% } %>
                </div>
                <div class="server-id"><%= server.id %></div>
              </div>
            </div>
          </label>
        <% }); %>
      </div>

    </form>
  <% } else { %>
    <div class="no-servers-hero">
      <div class="no-servers-icon">
        <i class="fab fa-discord"></i>
      </div>
      <h2 class="no-servers-title"><%
        const noServerTitles = {
          de: 'Bot noch nicht auf deinem Server?',
          en: 'Bot not on your server yet?',
          he: '◊î◊ë◊ï◊ò ◊¢◊ì◊ô◊ô◊ü ◊ú◊ê ◊ë◊©◊®◊™ ◊©◊ú◊ö?',
          ja: '„Éú„ÉÉ„Éà„ÅØ„Åæ„Å†„Çµ„Éº„Éê„Éº„Å´„ÅÑ„Åæ„Åõ„Çì„ÅãÔºü',
          ru: '–ë–æ—Ç –µ—â–µ –Ω–µ –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ?',
          pt: 'Bot ainda n√£o est√° no seu servidor?',
          es: '¬øBot a√∫n no est√° en tu servidor?',
          id: 'Bot belum ada di server Anda?',
          ar: 'ÿßŸÑÿ®Ÿàÿ™ ŸÑŸäÿ≥ ÿπŸÑŸâ ÿßŸÑÿÆÿßÿØŸÖ ÿßŸÑÿÆÿßÿµ ÿ®ŸÉ ÿ®ÿπÿØÿü'
        };
      %><%= noServerTitles[lang] || noServerTitles.de %></h2>
      <p class="no-servers-desc"><%
        const noServerDescs = {
          de: 'Du ben√∂tigst Administrator-Rechte auf einem Server, auf dem der Bot installiert ist, oder eine Team-Rolle.',
          en: 'You need administrator permissions on a server where the bot is installed, or a team role.',
          he: '◊ê◊™◊î ◊¶◊®◊ô◊ö ◊î◊®◊©◊ê◊ï◊™ ◊û◊†◊î◊ú ◊ë◊©◊®◊™ ◊©◊ë◊ï ◊î◊ë◊ï◊ò ◊û◊ï◊™◊ß◊ü, ◊ê◊ï ◊™◊§◊ß◊ô◊ì ◊¶◊ï◊ï◊™.',
          ja: '„Éú„ÉÉ„Éà„Åå„Ç§„É≥„Çπ„Éà„Éº„É´„Åï„Çå„Å¶„ÅÑ„Çã„Çµ„Éº„Éê„Éº„ÅÆÁÆ°ÁêÜËÄÖÊ®©Èôê„ÄÅ„Åæ„Åü„ÅØ„ÉÅ„Éº„É†ÂΩπËÅ∑„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ',
          ru: '–í–∞–º –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –≥–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –±–æ—Ç, –∏–ª–∏ —Ä–æ–ª—å –∫–æ–º–∞–Ω–¥—ã.',
          pt: 'Voc√™ precisa de permiss√µes de administrador em um servidor onde o bot est√° instalado, ou uma fun√ß√£o de equipe.',
          es: 'Necesitas permisos de administrador en un servidor donde el bot est√© instalado, o un rol de equipo.',
          id: 'Anda memerlukan izin administrator di server tempat bot diinstal, atau peran tim.',
          ar: 'ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ•ŸÑŸâ ÿ£ÿ∞ŸàŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ ÿπŸÑŸâ ÿÆÿßÿØŸÖ ÿ≠Ÿäÿ´ ÿ™ŸÖ ÿ™ÿ´ÿ®Ÿäÿ™ ÿßŸÑÿ®Ÿàÿ™ÿå ÿ£Ÿà ÿØŸàÿ± ŸÅÿ±ŸäŸÇ.'
        };
      %><%= noServerDescs[lang] || noServerDescs.de %></p>

      <div class="no-servers-actions">
        <a href="<%= inviteUrl %>" class="btn-invite" target="_blank">
          <i class="fab fa-discord"></i>
          <%
            const inviteBtnTexts = {
              de: 'Bot zu Discord hinzuf√ºgen',
              en: 'Add Bot to Discord',
              he: '◊î◊ï◊°◊£ ◊ë◊ï◊ò ◊ú-Discord',
              ja: '„Éú„ÉÉ„Éà„ÇíDiscord„Å´ËøΩÂä†',
              ru: '–î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞ –≤ Discord',
              pt: 'Adicionar Bot ao Discord',
              es: 'Agregar Bot a Discord',
              id: 'Tambahkan Bot ke Discord',
              ar: 'ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ®Ÿàÿ™ ÿ•ŸÑŸâ Discord'
            };
          %><%= inviteBtnTexts[lang] || inviteBtnTexts.de %>
        </a>
        <a href="/" class="btn-secondary">
          <i class="fas fa-home"></i>
          <%
            const homeBtnTexts = {
              de: 'Zur√ºck zur Startseite',
              en: 'Back to Home',
              he: '◊ó◊ñ◊®◊î ◊ú◊ì◊£ ◊î◊ë◊ô◊™',
              ja: '„Éõ„Éº„É†„Å´Êàª„Çã',
              ru: '–ù–∞ –≥–ª–∞–≤–Ω—É—é',
              pt: 'Voltar ao In√≠cio',
              es: 'Volver al Inicio',
              id: 'Kembali ke Beranda',
              ar: 'ÿßŸÑÿπŸàÿØÿ© ÿ•ŸÑŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©'
            };
          %><%= homeBtnTexts[lang] || homeBtnTexts.de %>
        </a>
      </div>

      <div class="no-servers-steps">
        <h3><%
          const stepsTitle = {
            de: 'So geht\'s weiter:',
            en: 'Next Steps:',
            he: '◊©◊ú◊ë◊ô◊ù ◊î◊ë◊ê◊ô◊ù:',
            ja: 'Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„ÉóÔºö',
            ru: '–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:',
            pt: 'Pr√≥ximos Passos:',
            es: 'Pr√≥ximos Pasos:',
            id: 'Langkah Selanjutnya:',
            ar: 'ÿßŸÑÿÆÿ∑Ÿàÿßÿ™ ÿßŸÑÿ™ÿßŸÑŸäÿ©:'
          };
        %><%= stepsTitle[lang] || stepsTitle.de %></h3>
        <div class="steps-list">
          <div class="step-item">
            <div class="step-num">1</div>
            <div class="step-content">
              <strong><%
                const step1Title = {
                  de: 'Bot einladen',
                  en: 'Invite Bot',
                  he: '◊î◊ñ◊û◊ü ◊ë◊ï◊ò',
                  ja: '„Éú„ÉÉ„Éà„ÇíÊãõÂæÖ',
                  ru: '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –±–æ—Ç–∞',
                  pt: 'Convidar Bot',
                  es: 'Invitar Bot',
                  id: 'Undang Bot',
                  ar: 'ŸÇŸÖ ÿ®ÿØÿπŸàÿ© ÿßŸÑÿ®Ÿàÿ™'
                };
              %><%= step1Title[lang] || step1Title.de %></strong>
              <p><%
                const step1Desc = {
                  de: 'Klicke auf den Button oben und w√§hle deinen Server aus',
                  en: 'Click the button above and select your server',
                  he: '◊ú◊ó◊• ◊¢◊ú ◊î◊õ◊§◊™◊ï◊® ◊ú◊û◊¢◊ú◊î ◊ï◊ë◊ó◊® ◊ê◊™ ◊î◊©◊®◊™ ◊©◊ú◊ö',
                  ja: '‰∏ä„ÅÆ„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Çµ„Éº„Éê„Éº„ÇíÈÅ∏Êäû',
                  ru: '–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä',
                  pt: 'Clique no bot√£o acima e selecione seu servidor',
                  es: 'Haz clic en el bot√≥n de arriba y selecciona tu servidor',
                  id: 'Klik tombol di atas dan pilih server Anda',
                  ar: 'ÿßŸÜŸÇÿ± ŸÅŸàŸÇ ÿßŸÑÿ≤ÿ± ÿ£ÿπŸÑÿßŸá Ÿàÿ≠ÿØÿØ ÿßŸÑÿÆÿßÿØŸÖ ÿßŸÑÿÆÿßÿµ ÿ®ŸÉ'
                };
              %><%= step1Desc[lang] || step1Desc.de %></p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-num">2</div>
            <div class="step-content">
              <strong><%
                const step2Title = {
                  de: 'Berechtigungen best√§tigen',
                  en: 'Confirm Permissions',
                  he: '◊ê◊©◊® ◊î◊®◊©◊ê◊ï◊™',
                  ja: 'Ê®©Èôê„ÇíÁ¢∫Ë™ç',
                  ru: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è',
                  pt: 'Confirmar Permiss√µes',
                  es: 'Confirmar Permisos',
                  id: 'Konfirmasi Izin',
                  ar: 'ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ£ÿ∞ŸàŸÜÿßÿ™'
                };
              %><%= step2Title[lang] || step2Title.de %></strong>
              <p><%
                const step2Desc = {
                  de: 'Der Bot ben√∂tigt Administrator-Rechte f√ºr volle Funktionalit√§t',
                  en: 'The bot needs administrator permissions for full functionality',
                  he: '◊î◊ë◊ï◊ò ◊¶◊®◊ô◊ö ◊î◊®◊©◊ê◊ï◊™ ◊û◊†◊î◊ú ◊ú◊§◊ï◊†◊ß◊¶◊ô◊ï◊†◊ú◊ô◊ï◊™ ◊û◊ú◊ê◊î',
                  ja: '„Éú„ÉÉ„Éà„ÅØÂÆåÂÖ®„Å™Ê©üËÉΩ„ÅÆ„Åü„ÇÅ„Å´ÁÆ°ÁêÜËÄÖÊ®©Èôê„ÅåÂøÖË¶Å„Åß„Åô',
                  ru: '–ë–æ—Ç—É –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏',
                  pt: 'O bot precisa de permiss√µes de administrador para funcionalidade completa',
                  es: 'El bot necesita permisos de administrador para funcionalidad completa',
                  id: 'Bot memerlukan izin administrator untuk fungsionalitas penuh',
                  ar: 'Ÿäÿ≠ÿ™ÿßÿ¨ ÿßŸÑÿ®Ÿàÿ™ ÿ•ŸÑŸâ ÿ£ÿ∞ŸàŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ ŸÑŸÑŸàÿ∏ÿßÿ¶ŸÅ ÿßŸÑŸÉÿßŸÖŸÑÿ©'
                };
              %><%= step2Desc[lang] || step2Desc.de %></p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-num">3</div>
            <div class="step-content">
              <strong><%
                const step3Title = {
                  de: 'Seite neu laden',
                  en: 'Reload Page',
                  he: '◊ò◊¢◊ü ◊û◊ó◊ì◊© ◊ê◊™ ◊î◊ì◊£',
                  ja: '„Éö„Éº„Ç∏„ÇíÂÜçË™≠„ÅøËæº„Åø',
                  ru: '–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É',
                  pt: 'Recarregar P√°gina',
                  es: 'Recargar P√°gina',
                  id: 'Muat Ulang Halaman',
                  ar: 'ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©'
                };
              %><%= step3Title[lang] || step3Title.de %></strong>
              <p><%
                const step3Desc = {
                  de: 'Kehre zu dieser Seite zur√ºck und dein Server wird erscheinen',
                  en: 'Return to this page and your server will appear',
                  he: '◊ó◊ñ◊ï◊® ◊ú◊ì◊£ ◊ñ◊î ◊ï◊î◊©◊®◊™ ◊©◊ú◊ö ◊ô◊ï◊§◊ô◊¢',
                  ja: '„Åì„ÅÆ„Éö„Éº„Ç∏„Å´Êàª„Çã„Å®„Çµ„Éº„Éê„Éº„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô',
                  ru: '–í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –ø–æ—è–≤–∏—Ç—Å—è',
                  pt: 'Retorne a esta p√°gina e seu servidor aparecer√°',
                  es: 'Regresa a esta p√°gina y tu servidor aparecer√°',
                  id: 'Kembali ke halaman ini dan server Anda akan muncul',
                  ar: 'ÿßÿ±ÿ¨ÿπ ÿ•ŸÑŸâ Ÿáÿ∞Ÿá ÿßŸÑÿµŸÅÿ≠ÿ© Ÿàÿ≥Ÿäÿ∏Ÿáÿ± ÿßŸÑÿÆÿßÿØŸÖ ÿßŸÑÿÆÿßÿµ ÿ®ŸÉ'
                };
              %><%= step3Desc[lang] || step3Desc.de %></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% } %>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text">Lade Server...</div>
      <div class="loading-subtext">Bitte warten</div>
    </div>
  </div>

  <footer>
    <p>TRS Tickets ¬© 2025 Theredstonee ‚Ä¢ Alle Rechte vorbehalten ‚Ä¢ Version <%= version %></p>
  </footer>

  <script>
    // Auto-submit on card click
    document.querySelectorAll('.server-card').forEach(card => {
      card.addEventListener('click', () => {
        document.querySelectorAll('.server-card').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');

        // Show loading overlay
        document.getElementById('loadingOverlay').classList.add('show');

        // Auto-submit form after selection
        setTimeout(() => {
          document.getElementById('serverForm').submit();
        }, 300);
      });
    });

    // Theme Toggle
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
      localStorage.setItem('trs-theme', newTheme);
      document.getElementById('themeIcon').className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    }

    // Theme beim Laden setzen
    (function() {
      const savedTheme = localStorage.getItem('trs-theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      document.getElementById('themeIcon').className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    })();

    // Loading animation for Home button
    const homeLink = document.querySelector('a[href="/"]');
    if (homeLink) {
      homeLink.addEventListener('click', function(e) {
        e.preventDefault();
        const href = this.getAttribute('href');

        const loadingOverlay = document.getElementById('loadingOverlay');
        const loadingText = loadingOverlay.querySelector('.loading-text');
        const loadingSubtext = loadingOverlay.querySelector('.loading-subtext');

        const lang = '<%= lang || "de" %>';
        const texts = {
          de: { text: 'Zur Startseite...', subtext: 'Bitte warten' },
          en: { text: 'Going to home...', subtext: 'Please wait' },
          he: { text: '◊ó◊ñ◊®◊î ◊ú◊ì◊£ ◊î◊ë◊ô◊™...', subtext: '◊ê◊†◊ê ◊î◊û◊™◊ü' },
          ja: { text: '„Éõ„Éº„É†„Å´ÁßªÂãï‰∏≠...', subtext: '„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ' },
          ru: { text: '–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é...', subtext: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ' },
          pt: { text: 'Indo para in√≠cio...', subtext: 'Por favor, aguarde' },
          es: { text: 'Yendo al inicio...', subtext: 'Por favor, espere' },
          id: { text: 'Ke beranda...', subtext: 'Mohon tunggu' },
          ar: { text: 'ÿßŸÑÿ∞Ÿáÿßÿ® ÿ•ŸÑŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©...', subtext: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±' }
        };

        const t = texts[lang] || texts.de;
        loadingText.textContent = t.text;
        loadingSubtext.textContent = t.subtext;
        loadingOverlay.classList.add('show');

        setTimeout(() => {
          window.location.href = href;
        }, 100);
      });
    }

    // Owner Dashboard Button Loading Animation
    const ownerDashboardBtn = document.getElementById('ownerDashboardBtn');
    if (ownerDashboardBtn) {
      ownerDashboardBtn.addEventListener('click', function(e) {
        e.preventDefault();
        const href = this.getAttribute('href');
        this.classList.add('loading');
        setTimeout(() => {
          window.location.href = href;
        }, 300);
      });
    }

    // Spin Toggle Funktion (mit sessionStorage)
    function toggleSpin() {
      const body = document.body;
      const settingsBtn = document.getElementById('settingsBtn');
      const isSpinning = body.classList.contains('spinning');

      if (isSpinning) {
        body.classList.remove('spinning');
        settingsBtn.classList.remove('active');
        sessionStorage.setItem('trs-spin-enabled', 'false');
      } else {
        body.classList.add('spinning');
        settingsBtn.classList.add('active');
        sessionStorage.setItem('trs-spin-enabled', 'true');
      }
    }

    // Spin-Zustand beim Laden wiederherstellen
    (function() {
      const spinEnabled = sessionStorage.getItem('trs-spin-enabled');
      if (spinEnabled === 'true') {
        document.body.classList.add('spinning');
        document.getElementById('settingsBtn').classList.add('active');
      }
    })();

    // Accelerating Spinner Animation (No Maximum)
    (function() {
      let secondsElapsed = 0;

      function accelerateSpinners() {
        const spinners = document.querySelectorAll('.loading-spinner, .owner-dashboard-btn.loading i');

        if (spinners.length === 0) return;

        secondsElapsed++;

        // Calculate new duration: 1 / (1 + 0.1 * seconds)
        // This increases speed by 0.1 rotations per second each second
        const rotationsPerSecond = 1 + (0.1 * secondsElapsed);
        const newDuration = 1 / rotationsPerSecond;

        spinners.forEach(spinner => {
          spinner.style.animationDuration = `${newDuration}s`;
        });
      }

      // Run every second
      setInterval(accelerateSpinners, 1000);
    })();

    // DVD Logo Bounce Animation for ALL Elements
    (function() {
      const colors = [
        '#00ff88', '#ff0088', '#ffff00', '#00ffff',
        '#ff8800', '#8800ff', '#00ff00', '#ff0000'
      ];

      let bouncingElements = [];
      let animationId = null;

      // Factory function to create bouncing element
      function createBouncingElement(element, speedX, speedY) {
        if (!element) return null;

        const rect = element.getBoundingClientRect();
        const computedStyle = window.getComputedStyle(element);

        return {
          element: element,
          x: rect.left,
          y: rect.top,
          dx: speedX,
          dy: speedY,
          colorIndex: Math.floor(Math.random() * colors.length),
          originalStyles: {
            position: computedStyle.position,
            top: computedStyle.top,
            left: computedStyle.left,
            right: computedStyle.right,
            bottom: computedStyle.bottom,
            background: computedStyle.background,
            backgroundColor: computedStyle.backgroundColor,
            transform: computedStyle.transform,
            margin: computedStyle.margin,
            zIndex: computedStyle.zIndex
          }
        };
      }

      function startDVDBounce() {
        if (animationId) return; // Already running

        bouncingElements = [];

        // Collect all elements to bounce
        const settingsBtn = document.getElementById('settingsBtn');
        const themeToggle = document.querySelector('.theme-toggle');
        const serverCards = document.querySelectorAll('.server-card');
        const navButtons = document.querySelectorAll('.nav-buttons a');
        const title = document.querySelector('h1');
        const subtitle = document.querySelector('.sub');
        const footer = document.querySelector('footer');

        // Add settings button
        if (settingsBtn) {
          const bouncer = createBouncingElement(settingsBtn, 2, 2);
          if (bouncer) {
            bouncer.element.style.position = 'fixed';
            bouncer.element.style.zIndex = '10000';
            bouncingElements.push(bouncer);
          }
        }

        // Add theme toggle
        if (themeToggle) {
          const bouncer = createBouncingElement(themeToggle, 2.5, 1.8);
          if (bouncer) {
            bouncer.element.style.position = 'fixed';
            bouncer.element.style.zIndex = '10000';
            bouncingElements.push(bouncer);
          }
        }

        // Add server cards with varying speeds
        serverCards.forEach((card, index) => {
          const speedX = 1.5 + (index * 0.3);
          const speedY = 1.3 + (index * 0.25);
          const bouncer = createBouncingElement(card, speedX, speedY);
          if (bouncer) {
            bouncer.element.style.position = 'fixed';
            bouncer.element.style.zIndex = '9000';
            bouncingElements.push(bouncer);
          }
        });

        // Add navigation buttons with varying speeds
        navButtons.forEach((btn, index) => {
          const speedX = 2.2 + (index * 0.4);
          const speedY = 1.9 + (index * 0.35);
          const bouncer = createBouncingElement(btn, speedX, speedY);
          if (bouncer) {
            bouncer.element.style.position = 'fixed';
            bouncer.element.style.zIndex = '9500';
            bouncingElements.push(bouncer);
          }
        });

        // Add title
        if (title) {
          const bouncer = createBouncingElement(title, 1.8, 2.2);
          if (bouncer) {
            bouncer.element.style.position = 'fixed';
            bouncer.element.style.zIndex = '9200';
            bouncingElements.push(bouncer);
          }
        }

        // Add subtitle
        if (subtitle) {
          const bouncer = createBouncingElement(subtitle, 2.3, 1.6);
          if (bouncer) {
            bouncer.element.style.position = 'fixed';
            bouncer.element.style.zIndex = '9200';
            bouncingElements.push(bouncer);
          }
        }

        // Add footer
        if (footer) {
          const bouncer = createBouncingElement(footer, 1.6, 2.4);
          if (bouncer) {
            bouncer.element.style.position = 'fixed';
            bouncer.element.style.zIndex = '9100';
            bouncingElements.push(bouncer);
          }
        }

        // Animation loop for all elements
        function animate() {
          bouncingElements.forEach(bouncer => {
            const width = bouncer.element.offsetWidth;
            const height = bouncer.element.offsetHeight;
            const maxX = window.innerWidth - width;
            const maxY = window.innerHeight - height;

            // Update position
            bouncer.x += bouncer.dx;
            bouncer.y += bouncer.dy;

            // Bounce off edges and change color
            if (bouncer.x <= 0 || bouncer.x >= maxX) {
              bouncer.dx = -bouncer.dx;
              bouncer.x = bouncer.x <= 0 ? 0 : maxX;
              bouncer.colorIndex = (bouncer.colorIndex + 1) % colors.length;
              bouncer.element.style.background = colors[bouncer.colorIndex];
            }

            if (bouncer.y <= 0 || bouncer.y >= maxY) {
              bouncer.dy = -bouncer.dy;
              bouncer.y = bouncer.y <= 0 ? 0 : maxY;
              bouncer.colorIndex = (bouncer.colorIndex + 1) % colors.length;
              bouncer.element.style.background = colors[bouncer.colorIndex];
            }

            // Apply new position
            bouncer.element.style.left = bouncer.x + 'px';
            bouncer.element.style.top = bouncer.y + 'px';
          });

          animationId = requestAnimationFrame(animate);
        }

        animate();
      }

      function stopDVDBounce() {
        if (animationId) {
          cancelAnimationFrame(animationId);
          animationId = null;
        }

        // Reset all elements to original styles
        bouncingElements.forEach(bouncer => {
          const elem = bouncer.element;
          const orig = bouncer.originalStyles;

          elem.style.position = orig.position;
          elem.style.top = orig.top;
          elem.style.left = orig.left;
          elem.style.right = orig.right;
          elem.style.bottom = orig.bottom;
          elem.style.background = orig.background;
          elem.style.backgroundColor = orig.backgroundColor;
          elem.style.transform = orig.transform;
          elem.style.margin = orig.margin;
          elem.style.zIndex = orig.zIndex;
        });

        bouncingElements = [];
      }

      // Override toggleSpin to include DVD bounce
      const originalToggleSpin = window.toggleSpin;
      window.toggleSpin = function() {
        originalToggleSpin();

        const isSpinning = document.body.classList.contains('spinning');
        if (isSpinning) {
          startDVDBounce();
        } else {
          stopDVDBounce();
        }
      };

      // Check if spinning is already active on page load
      const spinEnabled = sessionStorage.getItem('trs-spin-enabled');
      if (spinEnabled === 'true') {
        setTimeout(startDVDBounce, 100);
      }
    })();
  </script>
</body>
</html>
